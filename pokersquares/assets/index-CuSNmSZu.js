var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i);import{r as s}from"./phaser-UvlxNa5i.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i=s();class r extends i.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}function a(e){return["2","3","4","5","6","7","8","9","10","J","Q","K","A"].indexOf(e)}function o(e){if(5!==e.length)return{name:"Incomplete",score:0};const t=e.map((e=>e.slice(0,-1))),s=e.map((e=>e.slice(-1))),i={};t.forEach((e=>i[e]=(i[e]||0)+1));const r=Object.values(i).sort(((e,t)=>t-e)),o=s.every((e=>e===s[0])),n=t.map(a).sort(((e,t)=>e-t)),c=n.every(((e,t,s)=>0===t||e===s[t-1]+1)),d=JSON.stringify(n)===JSON.stringify([0,1,2,3,12]);return o&&c&&t.includes("A")&&t.includes("10")?{name:"Royal Flush",score:100}:o&&(c||d)?{name:"Straight Flush",score:75}:4===r[0]?{name:"Four of a Kind",score:50}:3===r[0]&&2===r[1]?{name:"Full House",score:25}:o?{name:"Flush",score:20}:c||d?{name:"Straight",score:15}:3===r[0]?{name:"Three of a Kind",score:10}:2===r[0]&&2===r[1]?{name:"Two Pair",score:5}:2===r[0]?{name:"One Pair",score:2}:{name:"High Card",score:0}}function n(e,t,s,i,r={}){const a={fontFamily:"Segoe UI, Arial, sans-serif",color:"#ffffff",fontSize:"16px",...r};return e.add.text(t,s,i,a)}function c(e,t,s,i,r,a,o){const n=e.add.graphics(),c=(e,t,s)=>{n.clear(),n.fillGradientStyle(e,t,e,t,1),n.fillRoundedRect(-100,-25,r,a,10),n.lineStyle(2,s,1),n.strokeRoundedRect(-100,-25,r,a,10)};c(13158,26316,52479);const d=e.add.text(0,0,i,{fontSize:"28px",fontFamily:"Segoe UI, Arial, sans-serif",color:"#ffffff"}).setOrigin(.5),h=e.add.container(t,s,[n,d]).setSize(r,a).setDepth(2).setInteractive(new Phaser.Geom.Rectangle(-100,-25,r,a),Phaser.Geom.Rectangle.Contains);return h.on("pointerover",(()=>{c(21930,39423,16777215)})),h.on("pointerout",(()=>{c(13158,26316,52479)})),h.on("pointerdown",(()=>{o()})),h}class d extends Phaser.Scene{constructor(){super("GameScene"),t(this,"background"),t(this,"deck",[]),t(this,"grid",[]),t(this,"cardSprites",[]),t(this,"gridSize",5),t(this,"selectedCard",null),t(this,"timerText"),t(this,"remainingTime",300),t(this,"handInfoTexts",[]),t(this,"nextCardImage"),t(this,"timerEvent"),t(this,"cardBackImages",[]),t(this,"cardWidth",146),t(this,"cardHeight",203),t(this,"cardGutter",10),t(this,"cardScale",.66)}preload(){this.load.image("back","assets/cards/back_light.png"),this.load.audio("cardsound32562-37691","assets/sfx/cardsound32562-37691.mp3"),this.load.audio("shuffle-cards-46455","assets/sfx/shuffle-cards-46455.mp3");const e=["clubs","diamonds","hearts","spades"],t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];for(const s of e)for(const e of t){const t=`${s}_${e}`;this.load.image(t,`assets/cards/${t}.png`)}}create(){this.background=this.add.image(512,384,"playbg"),this.handInfoTexts=[],this.deck=function(){const e=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];return["♠","♥","♦","♣"].flatMap((t=>e.map((e=>`${e}${t}`))))}(),this.sound.play("shuffle-cards-46455"),Phaser.Utils.Array.Shuffle(this.deck),this.grid=Array.from({length:this.gridSize},(()=>Array(this.gridSize).fill(null))),this.cardSprites=Array.from({length:this.gridSize},(()=>Array(this.gridSize).fill(null))),n(this,20,20,"Poker Squares by Tim Trott",{fontSize:"20px",color:"#ffffff"}),this.timerText=n(this,700,20,"Time: 5:00",{fontSize:"20px",color:"#ffffff"}),this.timerEvent=this.time.addEvent({delay:1e3,callback:()=>{this.remainingTime--;const e=Math.floor(this.remainingTime/60),t=this.remainingTime%60;this.timerText.setText(`Time: ${e}:${t.toString().padStart(2,"0")}`),this.remainingTime<=0&&this.timerEvent&&this.timerEvent.remove()},loop:!0}),this.drawNextCard(),this.renderGrid(),this.renderScoreTable()}drawNextCard(){this.selectedCard=this.deck.pop()??null,this.nextCardImage&&this.nextCardImage.destroy(),this.cardBackImages&&this.cardBackImages.forEach((e=>e.destroy())),this.cardBackImages=[],n(this,600,360,"Next Card",{fontSize:"18px",color:"#00ffff"});for(let t=0;t<5;t++){const e=this.add.image(650+5*t,450,"back").setDisplaySize(this.cardWidth,this.cardHeight).setOrigin(.5).setScale(this.cardScale).setDepth(t);this.cardBackImages.push(e)}const e=this.selectedCard?this.cardToImageKey(this.selectedCard):"back";this.nextCardImage=this.add.image(650,450,e).setDisplaySize(this.cardWidth,this.cardHeight).setOrigin(.5).setScale(this.cardScale).setDepth(10)}renderGrid(){for(let e=0;e<this.gridSize;e++)for(let t=0;t<this.gridSize;t++){const s=70+t*(this.cardWidth*this.cardScale+this.cardGutter),i=120+e*(this.cardHeight*this.cardScale+this.cardGutter),r=this.add.image(s,i,"back").setDisplaySize(this.cardWidth,this.cardHeight).setOrigin(.5).setScale(this.cardScale).setInteractive({cursor:"pointer"});r.on("pointerover",(()=>r.setTint(11184810))),r.on("pointerout",(()=>r.clearTint())),r.on("pointerdown",(()=>this.placeCard(e,t))),this.cardSprites[e][t]=r}}placeCard(e,t){if(this.grid[e][t]||!this.selectedCard)return;this.grid[e][t]=this.selectedCard;const s=this.cardSprites[e][t],i=this.cardToImageKey(this.selectedCard);this.tweens.add({targets:s,scaleX:0,duration:150,ease:"Bounce",onComplete:()=>{s.setTexture(i),this.sound.play("cardsound32562-37691"),this.tweens.add({targets:s,scaleX:this.cardScale,duration:100,ease:"Bounce",onComplete:()=>{s.disableInteractive(),s.clearTint()}})}}),this.selectedCard=null,this.nextCardImage&&this.nextCardImage.setTexture("back"),this.updateScoreTable(),this.checkGameEnd(),this.drawNextCard()}renderScoreTable(){n(this,600,50,"Score Table",{fontSize:"18px",color:"#00ffff"});for(let e=0;e<2*this.gridSize;e++){const t=n(this,600,90+25*e,(e<5?`Row ${e+1}`:"Col "+(e-4))+": -",{fontSize:"16px",color:"#ffffff"});this.handInfoTexts.push(t)}}updateScoreTable(){for(let e=0;e<this.gridSize;e++){const t=this.grid[e].filter((e=>e)),s=this.grid.map((t=>t[e])).filter((e=>e)),i=o(t),r=o(s);this.handInfoTexts[e].setText(`Row ${e+1}: ${i.name} (${i.score})`),this.handInfoTexts[e+5].setText(`Col ${e+1}: ${r.name} (${r.score})`)}}checkGameEnd(){if(!this.grid.flat().every((e=>null!==e)))return;this.timerEvent&&this.timerEvent.remove();const e=[];for(let r=0;r<this.gridSize;r++)e.push(o(this.grid[r].filter((e=>e)))),e.push(o(this.grid.map((e=>e[r])).filter((e=>e))));const t=e.reduce(((e,t)=>e+t.score),0),s=this.remainingTime,i=t+s;n(this,660,550,`Score: ${t}\nBonus: ${s}\nTotal: ${i}`,{fontSize:"20px",color:"#00ffff"}).setOrigin(.5),this.saveHighScore(i),c(this,700,620,"New Game",200,50,(()=>{this.scene.restart()}))}saveHighScore(e){const t="pokerSquaresHighScores",s=JSON.parse(localStorage.getItem(t)||"[]");s.push(e),s.sort(((e,t)=>t-e));const i=s.slice(0,10);localStorage.setItem(t,JSON.stringify(i))}cardToImageKey(e){const t=e.slice(0,-1);return`${{"♣":"clubs","♦":"diamonds","♥":"hearts","♠":"spades"}[e.slice(-1)]}_${t}`}}class h extends i.Scene{constructor(){super("MainMenu"),t(this,"background")}create(){this.background=this.add.image(512,384,"background"),this.add.rectangle(0,0,this.scale.width,this.scale.height,0,.5).setOrigin(0).setDepth(1),n(this,512,30,"Poker Squares",{fontSize:"40px",color:"#ffff00"}).setOrigin(.5).setDepth(2),n(this,10,740,"© Tim Trott - github.com/timtrottcodes",{fontSize:"16px",color:"#ffffff"}).setOrigin(0).setDepth(2),n(this,512,65,"By Tim Trott",{fontSize:"18px"}).setOrigin(.5).setDepth(2),n(this,200,100,"Top 10 Highscores",{fontSize:"24px",color:"#ffffff"}).setOrigin(.5,0).setDepth(2),JSON.parse(localStorage.getItem("pokerSquaresHighScores")||"[]").slice(0,10).forEach(((e,t)=>{n(this,200,140+24*t,`${t+1}. ${e}`,{fontSize:"20px",color:"#ffffff"}).setOrigin(.5,0).setDepth(2)}));const e=700;let t=100;n(this,e,t,"How to Play",{fontSize:"24px",color:"#ffffff"}).setOrigin(.5,0).setDepth(2),t+=30,["Place cards in a 5x5 grid.","Each row and column forms a poker hand.","Try to make the highest scoring hands.","You have 25 cards total."].forEach((s=>{n(this,e,t,s,{fontSize:"16px",color:"#cccccc",wordWrap:{width:400}}).setOrigin(.5,0).setDepth(2),t+=22})),t+=20,n(this,e,t,"Scoring",{fontSize:"24px",color:"#ffffff"}).setOrigin(.5,0).setDepth(2),t+=30,[["Royal Flush",100],["Straight Flush",75],["Four of a Kind",50],["Full House",25],["Flush",20],["Straight",15],["Three of a Kind",10],["Two Pair",5],["One Pair",2],["High Card",0]].forEach((([s,i])=>{n(this,e,t,`${s}: ${i}`,{fontSize:"18px",color:"#dddddd"}).setOrigin(.5,0).setDepth(2),t+=20})),c(this,512,700,"New Game",200,50,(()=>{this.scene.start("GameScene")}))}}class l extends i.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const e=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(t=>{e.width=4+460*t}))}preload(){this.load.setPath("assets"),this.load.image("playbg","playbg.png")}create(){this.scene.start("MainMenu")}}const f={type:i.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#028af8",scene:[r,l,h,d]};document.addEventListener("DOMContentLoaded",(()=>{new i.Game({...f,parent:"game-container"})}));
