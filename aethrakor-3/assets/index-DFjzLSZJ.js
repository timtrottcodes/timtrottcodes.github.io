var e=Object.defineProperty,t=(t,s,n)=>((t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n)(t,"symbol"!=typeof s?s+"":s,n);import{r as s,g as n}from"./phaser-CLYd3JIB.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var r=s();const o=n(r);class a extends r.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/backgrounds/menu.jpg")}create(){this.scene.start("Preloader")}}const i=JSON.parse('[{"id":"card_foot_soldier","name":"Town Foot Soldier","description":"A dependable militia fighter trained to hold the line in village skirmishes.","rarity":"Ordinary","attack":2,"health":5,"specialAbility":"None"},{"id":"card_archer","name":"Village Archer","description":"A hunter turned archer, skilled at striking from the treeline.","rarity":"Ordinary","attack":3,"health":3,"specialAbility":"None"},{"id":"card_apprentice_mage","name":"Apprentice Mage","description":"A novice in the arcane arts, eager to prove their worth with basic spells.","rarity":"Ordinary","attack":3,"health":4,"specialAbility":"None"},{"id":"card_squire","name":"Loyal Squire","description":"A young hopeful clad in hand-me-down armor, ready to serve and learn.","rarity":"Ordinary","attack":2,"health":4,"specialAbility":"None"},{"id":"card_wild_scout","name":"Wildlands Scout","description":"A nimble traveler of the forest paths, skilled in tracking and survival.","rarity":"Ordinary","attack":3,"health":4,"specialAbility":"None"},{"id":"card_healer_initiate","name":"Healer Initiate","description":"A temple trainee with minor restorative magic and herbal knowledge.","rarity":"Ordinary","attack":2,"health":5,"specialAbility":"Healer"},{"id":"card_farm_guard","name":"Farmstead Guard","description":"A pitchfork-wielding defender of fields and family.","rarity":"Ordinary","attack":2,"health":4,"specialAbility":"None"},{"id":"card_brawler","name":"Tavern Brawler","description":"Tough as nails and fueled by ale, this brawler handles trouble with fists.","rarity":"Ordinary","attack":2,"health":5,"specialAbility":"None"},{"id":"card_woodland_hermit","name":"Woodland Hermit","description":"An odd recluse with strange charms and a squirrel companion.","rarity":"Ordinary","attack":2,"health":5,"specialAbility":"None"},{"id":"card_messenger","name":"Swift Messenger","description":"A runner who knows the roads and relays messages under any threat.","rarity":"Ordinary","attack":3,"health":5,"specialAbility":"None"},{"id":"card_rat_catcher","name":"Rat Catcher","description":"Armed with traps and grit, keeps villages safe from vermin and worse.","rarity":"Common","attack":2,"health":5,"specialAbility":"None"},{"id":"card_rookie_sellsword","name":"Rookie Sellsword","description":"An eager mercenary hoping to earn fame one swing at a time.","rarity":"Common","attack":3,"health":4,"specialAbility":"None"},{"id":"card_grave_digger","name":"Grave Digger","description":"Spends more time around the dead than the living, but no less brave.","rarity":"Common","attack":2,"health":6,"specialAbility":"None"},{"id":"card_barn_watch","name":"Barn Watch","description":"Keeps eyes on livestock and local threats, pitchfork always nearby.","rarity":"Common","attack":2,"health":6,"specialAbility":"None"},{"id":"card_field_surgeon","name":"Field Surgeon","description":"Treats wounds with poultices and grit amid the chaos of battle.","rarity":"Common","attack":3,"health":6,"specialAbility":"None"},{"id":"card_river_fisher","name":"River Fisher","description":"Knows the waterways better than any map could hope to show.","rarity":"Common","attack":3,"health":5,"specialAbility":"None"},{"id":"card_mill_guard","name":"Mill Guard","description":"Protects grain and workers from bandits and beasts alike.","rarity":"Common","attack":2,"health":6,"specialAbility":"None"},{"id":"card_rooftop_runner","name":"Rooftop Runner","description":"Delivers messages or blades through the narrow skyline paths.","rarity":"Common","attack":3,"health":4,"specialAbility":"None"},{"id":"card_stable_hand","name":"Stable Hand","description":"Works with beasts daily, more formidable than they look.","rarity":"Common","attack":3,"health":7,"specialAbility":"None"},{"id":"card_gutter_scrapper","name":"Gutter Scrapper","description":"Raised in alleys, fights with anything not nailed down.","rarity":"Common","attack":3,"health":5,"specialAbility":"None"},{"id":"card_silent_watcher","name":"Silent Watcher","description":"Keeps the night vigil without complaint or fear.","rarity":"Common","attack":4,"health":8,"specialAbility":"None"},{"id":"card_garden_keeper","name":"Garden Keeper","description":"Tends to herbs and knows a thing or two about poisons.","rarity":"Common","attack":4,"health":7,"specialAbility":"None"},{"id":"card_cobbler","name":"Village Cobbler","description":"Fixes boots—and occasionally bandits—with a heavy hammer.","rarity":"Common","attack":4,"health":7,"specialAbility":"None"},{"id":"card_hill_runner","name":"Hill Runner","description":"Knows every rise and shortcut—vanishes as fast as they strike.","rarity":"Common","attack":4,"health":6,"specialAbility":"None"},{"id":"card_bellringer","name":"Bellringer","description":"Rings alarms or skulls depending on the occasion.","rarity":"Common","attack":3,"health":5,"specialAbility":"None"},{"id":"card_ox_driver","name":"Ox Driver","description":"Drives stubborn beasts, and sometimes bandits, with equal force.","rarity":"Common","attack":4,"health":7,"specialAbility":"None"},{"id":"card_barrel_basher","name":"Barrel Basher","description":"Smashes casks and occasionally skulls when drunk enough.","rarity":"Common","attack":5,"health":7,"specialAbility":"None"},{"id":"card_sling_boy","name":"Sling Boy","description":"A street kid with deadly aim and nothing to lose.","rarity":"Common","attack":5,"health":4,"specialAbility":"None"},{"id":"card_faithful_herald","name":"Faithful Herald","description":"Delivers royal decrees under threat of steel and storm.","rarity":"Common","attack":4,"health":8,"specialAbility":"None"},{"id":"card_quiet_herbalist","name":"Quiet Herbalist","description":"Treats wounds and raises eyebrows with mysterious teas.","rarity":"Common","attack":4,"health":8,"specialAbility":"None"},{"id":"card_duskblade_knight","name":"Duskblade Knight","description":"A disciplined warrior trained in both blade and shadow, guarding the kingdom\'s borders at twilight.","rarity":"Uncommon","attack":5,"health":10,"specialAbility":"None"},{"id":"card_ember_seer","name":"Ember Seer","description":"A fire-touched mage who sees fate in the flames and scorches foes with ember curses.","rarity":"Uncommon","attack":5,"health":9,"specialAbility":"None"},{"id":"card_stonewarden","name":"Stonewarden","description":"Clad in rune-inscribed stoneplate, this guardian channels ancient power to shield allies.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"card_windrider_scout","name":"Windrider Scout","description":"An elite outrider who can traverse the wilds at remarkable speed, warning of danger before it arrives.","rarity":"Uncommon","attack":5,"health":8,"specialAbility":"None"},{"id":"card_veil_cleric","name":"Veil Cleric","description":"A quiet priest of the lunar veil, adept in warding magics and subtle healing rituals.","rarity":"Uncommon","attack":5,"health":7,"specialAbility":"None"},{"id":"card_runeblade_apprentice","name":"Runeblade Apprentice","description":"A student of ancient sword-magic, capable of infusing strikes with unstable arcane energy.","rarity":"Uncommon","attack":5,"health":8,"specialAbility":"None"},{"id":"card_battle_ranger","name":"Battle Ranger","description":"Equally skilled with bow and blade, this seasoned woodsman strikes swiftly from cover.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"card_ashen_warlock","name":"Ashen Warlock","description":"Draped in cinders and whispered pacts, the warlock summons minor spirits to do their bidding.","rarity":"Uncommon","attack":5,"health":9,"specialAbility":"None"},{"id":"card_glaivemaster","name":"Glaivemaster","description":"A disciplined martial artist whose sweeping glaive forms keep foes at bay with deadly precision.","rarity":"Uncommon","attack":8,"health":8,"specialAbility":"None"},{"id":"card_gravetender","name":"Gravetender","description":"A somber caretaker who communes with the dead and commands protective bone wards.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"card_blade_acolyte","name":"Blade Acolyte","description":"Trained in temple combat forms, swift and precise.","rarity":"Uncommon","attack":5,"health":10,"specialAbility":"None"},{"id":"card_firewatch_guardian","name":"Firewatch Guardian","description":"Keeps the signal fires lit and enemies at bay.","rarity":"Uncommon","attack":5,"health":8,"specialAbility":"None"},{"id":"card_crimson_path_warrior","name":"Crimson Path Warrior","description":"Follows an ancient martial tradition honed in blood and discipline.","rarity":"Uncommon","attack":6,"health":9,"specialAbility":"None"},{"id":"card_moonveil_sentinel","name":"Moonveil Sentinel","description":"A guardian of lunar shrines who strikes under moonlight.","rarity":"Uncommon","attack":5,"health":9,"specialAbility":"None"},{"id":"card_iron_grove_hunter","name":"Iron Grove Hunter","description":"Stalks prey in the steelwood wilds with silent precision.","rarity":"Uncommon","attack":5,"health":8,"specialAbility":"None"},{"id":"card_rift_mage","name":"Rift Mage","description":"Manipulates unstable portals to disorient enemies.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"card_dune_walker","name":"Dune Walker","description":"Master of survival and surprise in desert ambushes.","rarity":"Uncommon","attack":7,"health":9,"specialAbility":"None"},{"id":"card_twilight_slinger","name":"Twilight Slinger","description":"Blends speed and shadow to deliver deadly bolts.","rarity":"Uncommon","attack":6,"health":10,"specialAbility":"None"},{"id":"card_flameforged_adept","name":"Flameforged Adept","description":"Trains near volcanic vents to temper fire magic and flesh.","rarity":"Uncommon","attack":8,"health":7,"specialAbility":"None"},{"id":"card_windveil_runner","name":"Windveil Runner","description":"Faster than most horses, this scout is rarely seen twice.","rarity":"Uncommon","attack":5,"health":9,"specialAbility":"None"},{"id":"card_emberborn_duelist","name":"Emberborn Duelist","description":"Uses burning blades in a whirling dance of death.","rarity":"Uncommon","attack":8,"health":7,"specialAbility":"None"},{"id":"card_veilweaver","name":"Veilweaver","description":"Bends illusion to mask movements and deceive foes.","rarity":"Uncommon","attack":6,"health":7,"specialAbility":"None"},{"id":"card_moss_caller","name":"Moss Caller","description":"Communes with forest spirits to entangle and heal.","rarity":"Uncommon","attack":8,"health":7,"specialAbility":"None"},{"id":"card_bloodrune_fighter","name":"Bloodrune Fighter","description":"Draws power from old runes carved into skin and steel.","rarity":"Uncommon","attack":7,"health":9,"specialAbility":"None"},{"id":"card_starborn_mystic","name":"Starborn Mystic","description":"Born under a rare omen, touched by stellar wisdom.","rarity":"Uncommon","attack":8,"health":7,"specialAbility":"None"},{"id":"card_solar_paladin","name":"Solar Paladin","description":"A radiant champion of the sun, wielding divine light to smite darkness and protect allies.","rarity":"Rare","attack":9,"health":14,"specialAbility":"None"},{"id":"card_shadowblade_assassin","name":"Shadowblade Assassin","description":"A master of stealth and lethal precision, striking swiftly from the shadows with deadly grace.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_emberstorm_sorcerer","name":"Emberstorm Sorcerer","description":"Harnesses the fury of blazing storms, unleashing fiery chaos upon enemies in a torrent of destruction.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_frostguard_warden","name":"Frostguard Warden","description":"A stalwart defender forged in icy realms, freezing foes in place and shielding comrades from harm.","rarity":"Rare","attack":7,"health":12,"specialAbility":"None"},{"id":"card_dawnseeker_ranger","name":"Dawnseeker Ranger","description":"An elite tracker who blends with the morning light, delivering precise strikes before foes can react.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_ironfist_berserker","name":"Ironfist Berserker","description":"A fearsome warrior who channels raw fury into devastating blows that crush all in their path.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_mystic_seer","name":"Mystic Seer","description":"A sage with deep foresight, weaving arcane knowledge to manipulate the battlefield\'s flow.","rarity":"Rare","attack":7,"health":13,"specialAbility":"None"},{"id":"card_voidblade_duelist","name":"Voidblade Duelist","description":"Wields a blade forged from the void itself, striking with supernatural speed and precision.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_stormbreaker_champion","name":"Stormbreaker Champion","description":"Calls down lightning to empower their strikes, breaking enemy ranks with electrifying force.","rarity":"Rare","attack":9,"health":16,"specialAbility":"None"},{"id":"card_gloomwarden","name":"Gloomwarden","description":"A shadowy sentinel who guards forgotten places, unleashing darkness to blind and weaken foes.","rarity":"Rare","attack":8,"health":13,"specialAbility":"None"},{"id":"card_ashbringer_knight","name":"Ashbringer Knight","description":"Rides into battle clad in scorched steel and fury.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_crystal_fury","name":"Crystal Fury","description":"A golem powered by ancient gems, surging with volatile energy.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_soulforge_binder","name":"Soulforge Binder","description":"Binds spirits into armor and weapons to enhance their wrath.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_voidstep_hunter","name":"Voidstep Hunter","description":"Appears from nowhere, leaves behind whispers and corpses.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_frostbite_champion","name":"Frostbite Champion","description":"A knight of the northern reaches, radiating a killing chill.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_dreamweaver","name":"Dreamweaver","description":"Warps reality and memory in ethereal patterns of combat.","rarity":"Rare","attack":7,"health":12,"specialAbility":"None"},{"id":"card_wildheart_avenger","name":"Wildheart Avenger","description":"Fights for fallen beasts and forgotten groves.","rarity":"Rare","attack":7,"health":14,"specialAbility":"None"},{"id":"card_thunderfist_sentinel","name":"Thunderfist Sentinel","description":"Each blow shakes the battlefield with roaring force.","rarity":"Rare","attack":8,"health":16,"specialAbility":"None"},{"id":"card_lorebound_magus","name":"Lorebound Magus","description":"Master of arcane knowledge and ancient spells.","rarity":"Rare","attack":6,"health":12,"specialAbility":"None"},{"id":"card_gloomfang_stalker","name":"Gloomfang Stalker","description":"Lurks in cursed woods, preying upon the unwary.","rarity":"Rare","attack":6,"health":12,"specialAbility":"None"},{"id":"card_stormlord_valerian","name":"Stormlord Valerian","description":"A legendary commander who commands thunder and lightning, devastating enemies with storm fury.","rarity":"Epic","attack":12,"health":24,"specialAbility":"None"},{"id":"card_blade_dancer_elyra","name":"Blade Dancer Elyra","description":"A graceful warrior whose deadly swordplay weaves through enemies with unmatched speed and precision.","rarity":"Epic","attack":11,"health":22,"specialAbility":"None"},{"id":"card_arcane_sentinel","name":"Arcane Sentinel","description":"A towering guardian infused with arcane energy, shielding allies and unleashing magical blasts.","rarity":"Epic","attack":11,"health":20,"specialAbility":"None"},{"id":"card_ember_revenant","name":"Ember Revenant","description":"A fiery spirit risen from ashes, burning enemies with relentless fury and unyielding resolve.","rarity":"Epic","attack":13,"health":26,"specialAbility":"None"},{"id":"card_frostborn_warlord","name":"Frostborn Warlord","description":"An ice-clad conqueror who freezes the battlefield, shattering foes with brutal strikes.","rarity":"Epic","attack":12,"health":24,"specialAbility":"None"},{"id":"card_shadowbane_inquisitor","name":"Shadowbane Inquisitor","description":"Hunter of darkness who purges evil with holy wrath and unbreakable conviction.","rarity":"Epic","attack":11,"health":22,"specialAbility":"None"},{"id":"card_soulforge_blacksmith","name":"Soulforge Blacksmith","description":"Master craftsman whose enchanted weapons bring death and despair to enemies.","rarity":"Epic","attack":9,"health":25,"specialAbility":"None"},{"id":"card_ironclad_paladin","name":"Ironclad Paladin","description":"A bastion of defense clad in impenetrable armor, standing firm against overwhelming odds.","rarity":"Epic","attack":10,"health":20,"specialAbility":"None"},{"id":"card_windrunner_scout","name":"Windrunner Scout","description":"Fleet-footed and sharp-eyed, strikes first and vanishes before enemies can retaliate.","rarity":"Epic","attack":11,"health":18,"specialAbility":"None"},{"id":"card_thunderstrike_champion","name":"Thunderstrike Champion","description":"Calls the fury of storms down upon foes, crushing them with electrifying might.","rarity":"Epic","attack":12,"health":24,"specialAbility":"None"},{"id":"card_aurion_stormbreaker","name":"Aurion Stormbreaker","description":"The fabled hero who shattered the sky\'s wrath, wielding thunder to protect the realms.","rarity":"Legendary","attack":18,"health":36,"specialAbility":"None"},{"id":"card_seraphina_dawnblade","name":"Seraphina Dawnblade","description":"A radiant warrior whose sword shines with the light of dawn, banishing darkness.","rarity":"Legendary","attack":17,"health":34,"specialAbility":"None"},{"id":"card_valdris_shadowbane","name":"Valdris Shadowbane","description":"The relentless hunter of shadows, feared by evil and revered by allies.","rarity":"Legendary","attack":16,"health":32,"specialAbility":"None"},{"id":"card_lyra_windwhisper","name":"Lyra Windwhisper","description":"A mystic archer who commands the winds, striking silently and vanishing like the breeze.","rarity":"Legendary","attack":15,"health":30,"specialAbility":"None"},{"id":"card_drakor_ironfist","name":"Drakor Ironfist","description":"A titan of strength whose fists crush mountains and enemies alike.","rarity":"Legendary","attack":19,"health":38,"specialAbility":"None"},{"id":"card_elowen_moonshadow","name":"Elowen Moonshadow","description":"An elusive assassin who blends with the night, striking with deadly precision.","rarity":"Legendary","attack":16,"health":32,"specialAbility":"None"},{"id":"card_thalor_fireheart","name":"Thalor Fireheart","description":"A fierce pyromancer whose burning passion ignites the battlefield.","rarity":"Legendary","attack":18,"health":36,"specialAbility":"None"},{"id":"card_isolde_soulwarden","name":"Isolde Soulwarden","description":"Guardian of the sacred realm, wielding holy power to heal and protect.","rarity":"Legendary","attack":16,"health":38,"specialAbility":"None"},{"id":"card_ragnar_thundermaul","name":"Ragnar Thundermaul","description":"Warlord of the storm clans, smashing foes with the might of the tempest.","rarity":"Legendary","attack":19,"health":38,"specialAbility":"None"},{"id":"card_lyssara_everlight","name":"Lyssara Everlight","description":"A beacon of hope and justice, whose presence inspires allies to victory.","rarity":"Legendary","attack":18,"health":32,"specialAbility":"None"}]'),m=JSON.parse('[{"id":"monster_goblin_scout","name":"Goblin Scout","description":"A sneaky goblin with sharp eyes and sharper teeth.","rarity":"Ordinary","attack":2,"health":4,"specialAbility":"None"},{"id":"monster_gnoll_grunt","name":"Gnoll Grunt","description":"A savage hyena-like warrior.","rarity":"Ordinary","attack":2,"health":3,"specialAbility":"None"},{"id":"monster_wolves","name":"Wolves","description":"A hungry pack that strikes together.","rarity":"Ordinary","attack":3,"health":4,"specialAbility":"None"},{"id":"monster_feral_dog","name":"Feral Dog","description":"Snarling, fast, and vicious.","rarity":"Ordinary","attack":2,"health":4,"specialAbility":"None"},{"id":"monster_lurking_thief","name":"Lurking Thief","description":"Steals more than your gold.","rarity":"Ordinary","attack":3,"health":4,"specialAbility":"None"},{"id":"monster_shadow_rat","name":"Shadow Rat","description":"Moves quickly through the darkness.","rarity":"Ordinary","attack":2,"health":2,"specialAbility":"None"},{"id":"monster_moss_golem","name":"Moss Golem","description":"Slow, moss-covered, and stubborn.","rarity":"Common","attack":2,"health":5,"specialAbility":"None"},{"id":"monster_bandit_thug","name":"Bandit Thug","description":"Common road scum with a blade.","rarity":"Common","attack":2,"health":4,"specialAbility":"None"},{"id":"monster_lizardkin_scout","name":"Lizardkin Scout","description":"A nimble fighter from the marshlands.","rarity":"Common","attack":2,"health":4,"specialAbility":"None"},{"id":"monster_hobgoblin","name":"Hobgoblin","description":"Larger and more organized than goblins.","rarity":"Uncommon","attack":4,"health":9,"specialAbility":"None"},{"id":"monster_cave_bat","name":"Cave Bat","description":"Small and fast, with a high-pitched screech.","rarity":"Uncommon","attack":5,"health":7,"specialAbility":"None"},{"id":"monster_forest_spider","name":"Forest Spider","description":"Camouflaged in the trees, waiting to pounce.","rarity":"Common","attack":6,"health":6,"specialAbility":"None"},{"id":"monster_torch_bug","name":"Torch Bug","description":"Explodes in a flash when cornered.","rarity":"Common","attack":5,"health":8,"specialAbility":"None"},{"id":"monster_venom_spider","name":"Venom Spider","description":"Its bite weakens even the strongest.","rarity":"Uncommon","attack":6,"health":7,"specialAbility":"None"},{"id":"monster_corrupted_sylvana","name":"Corrupted Sylvana","description":"Once a guardian spirit of the forest, now a vengeful wraith of thorns and decay.","rarity":"Uncommon","attack":6,"health":10,"specialAbility":"None"},{"id":"monster_slime","name":"Slime","description":"Sticky and acidic, but mostly annoying.","rarity":"Common","attack":4,"health":8,"specialAbility":"None"},{"id":"monster_swamp_rat","name":"Swamp Rat","description":"Carries more disease than danger.","rarity":"Common","attack":4,"health":6,"specialAbility":"None"},{"id":"monster_bone_crawler","name":"Bone Crawler","description":"Creeps across walls and ceilings.","rarity":"Common","attack":6,"health":7,"specialAbility":"None"},{"id":"monster_dire_wolf","name":"Dire Wolf","description":"Twice the size of a normal wolf.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"monster_skeleton","name":"Skeleton","description":"A rattling pile of bones with a rusty sword.","rarity":"Common","attack":6,"health":8,"specialAbility":"None"},{"id":"monster_ghoul","name":"Ghoul","description":"Feasts on the flesh of the dead—and the living.","rarity":"Uncommon","attack":6,"health":9,"specialAbility":"None"},{"id":"monster_wight","name":"Wight","description":"Unliving and full of hatred.","rarity":"Uncommon","attack":8,"health":7,"specialAbility":"None"},{"id":"monster_tomb_guardian","name":"Tomb Guardian","description":"Bound to protect ancient treasures.","rarity":"Uncommon","attack":6,"health":7,"specialAbility":"None"},{"id":"monster_bog_hag","name":"Bog Hag","description":"Casts curses and summons swamp beasts.","rarity":"Rare","attack":7,"health":10,"specialAbility":"None"},{"id":"monster_stormbound_general","name":"Stormbound General","description":"A ghostly warrior with a blade of frost.","rarity":"Rare","attack":8,"health":14,"specialAbility":"None"},{"id":"monster_zombie","name":"Zombie","description":"Slow, dumb, but hard to put down.","rarity":"Uncommon","attack":7,"health":9,"specialAbility":"None"},{"id":"monster_grave_robber","name":"Grave Robber","description":"Uses trickery and speed to survive.","rarity":"Uncommon","attack":6,"health":8,"specialAbility":"None"},{"id":"monster_bandit_leader","name":"Bandit Leader","description":"Leads with brutality and greed.","rarity":"Uncommon","attack":7,"health":8,"specialAbility":"None"},{"id":"monster_troll_spawn","name":"Troll Spawn","description":"Tough-skinned and regenerating slowly.","rarity":"Uncommon","attack":6,"health":9,"specialAbility":"None"},{"id":"monster_stone_golem","name":"Stone Golem","description":"Nearly immovable and incredibly strong.","rarity":"Rare","attack":7,"health":10,"specialAbility":"None"},{"id":"monster_heretic_prince","name":"Heretic Prince","description":"Channels forbidden magics to drain life.","rarity":"Rare","attack":8,"health":15,"specialAbility":"None"},{"id":"monster_imp","name":"Imp","description":"A mischievous firestarter from the underworld.","rarity":"Rare","attack":6,"health":9,"specialAbility":"None"},{"id":"monster_dust_wraith","name":"Dust Wraith","description":"Barely corporeal, but still deadly.","rarity":"Rare","attack":9,"health":10,"specialAbility":"None"},{"id":"monster_carrion_drake","name":"Carrion Drake","description":"A scavenger dragon with acidic spit.","rarity":"Uncommon","attack":9,"health":12,"specialAbility":"None"},{"id":"monster_flame_wisp","name":"Flame Wisp","description":"A sentient ball of fire and fury.","rarity":"Uncommon","attack":8,"health":9,"specialAbility":"None"},{"id":"monster_dark_acolyte","name":"Dark Acolyte","description":"Channels forbidden magics to drain life.","rarity":"Rare","attack":8,"health":11,"specialAbility":"None"},{"id":"monster_minotaur","name":"Minotaur","description":"A brutal beast with a charging attack.","rarity":"Rare","attack":9,"health":14,"specialAbility":"None"},{"id":"monster_nightmare_steed","name":"Nightmare Steed","description":"Tramples foes under a burning mane.","rarity":"Rare","attack":10,"health":11,"specialAbility":"None"},{"id":"monster_blade_dancer","name":"Blade Dancer","description":"Fast, precise, and deadly in duels.","rarity":"Rare","attack":11,"health":8,"specialAbility":"None"},{"id":"monster_voidcaller","name":"Voidcaller","description":"Summons horrors from beyond the veil.","rarity":"Epic","attack":12,"health":16,"specialAbility":"None"},{"id":"monster_abyssal_spawn","name":"Abyssal Spawn","description":"Born of the void, and hungers for life.","rarity":"Rare","attack":13,"health":15,"specialAbility":"None"},{"id":"monster_obsidian_knight","name":"Obsidian Knight","description":"His oath unbroken. His soul bound. He will not let anyone past.","rarity":"Epic","attack":14,"health":18,"specialAbility":"None"},{"id":"monster_necromancer","name":"Necromancer","description":"Raises allies from fallen enemies.","rarity":"Rare","attack":11,"health":13,"specialAbility":"None"},{"id":"monster_flame_elemental","name":"Flame Elemental","description":"Its touch ignites all it strikes.","rarity":"Rare","attack":12,"health":14,"specialAbility":"None"},{"id":"monster_dracolich","name":"Dracolich","description":"An undead dragon with arcane powers.","rarity":"Epic","attack":12,"health":11,"specialAbility":"None"},{"id":"monster_lich","name":"Lich","description":"A master of death magic, nearly immortal.","rarity":"Epic","attack":13,"health":12,"specialAbility":"None"},{"id":"monster_storm_revenant","name":"Storm Revenant","description":"Commands the skies with thunder.","rarity":"Epic","attack":14,"health":11,"specialAbility":"None"},{"id":"monster_fire_troll","name":"Fire Troll","description":"Immune to pain, and stronger in fire.","rarity":"Epic","attack":14,"health":12,"specialAbility":"None"},{"id":"monster_phoenix_warden","name":"Phoenix Warden","description":"Revives once per battle in a blaze.","rarity":"Epic","attack":12,"health":14,"specialAbility":"None"},{"id":"monster_bone_colossus","name":"Bone Colossus","description":"A giant made of hundreds of corpses.","rarity":"Epic","attack":13,"health":17,"specialAbility":"None"},{"id":"monster_blood_queen","name":"Blood Queen","description":"Strikes from the shadows with deadly precision.","rarity":"Legendary","attack":14,"health":25,"specialAbility":"None"},{"id":"monster_chronarch","name":"Chronarch","description":"A being of glass and starlight.","rarity":"Epic","attack":16,"health":26,"specialAbility":"None"},{"id":"monster_abyssal_crawler","name":"Abyssal Crawler","description":"A nightmarish creature with glistening limbs and a hunger for warm blood.","rarity":"Epic","attack":18,"health":24,"specialAbility":"None"},{"id":"monster_onyx_gargantuan","name":"Onyx Gargantuan","description":"A towering golem formed from compressed stone and fossilized remains.","rarity":"Epic","attack":17,"health":22,"specialAbility":"None"},{"id":"monster_void_tunneler","name":"Void Tunneler","description":"Burrows through rock and reality alike.","rarity":"Epic","attack":16,"health":18,"specialAbility":"None"},{"id":"monster_fungal_colossus","name":"Fungal Colossus","description":"A living cave of spores and decay.","rarity":"Epic","attack":17,"health":18,"specialAbility":"None"},{"id":"monster_stone_maw_basilisk","name":"Stone Maw Basilisk","description":"With eyes that turn flesh to stone.","rarity":"Epic","attack":20,"health":18,"specialAbility":"None"},{"id":"monster_runebound_construct","name":"Runebound Construct","description":"Powered by lost magical inscriptions.","rarity":"Epic","attack":19,"health":22,"specialAbility":"None"},{"id":"monster_balgrim_the_vile","name":"Balgrim the Vile","description":"A demon warlord with an endless thirst for blood.","rarity":"Legendary","attack":24,"health":27,"specialAbility":"None"},{"id":"monster_zarael_the_flameborn","name":"Zarael the Flameborn","description":"A legendary phoenix demon, reborn from ash.","rarity":"Legendary","attack":22,"health":28,"specialAbility":"None"},{"id":"monster_thornshade_the_eternal","name":"Thornshade the Eternal","description":"A druidic horror who commands the forest itself.","rarity":"Legendary","attack":26,"health":22,"specialAbility":"None"},{"id":"monster_korthax_the_unchained","name":"Korthax the Unchained","description":"A titan once sealed in ancient times.","rarity":"Legendary","attack":22,"health":29,"specialAbility":"None"},{"id":"monster_xalzaroth","name":"Xal’Zaroth","description":"A shadow demon who devours hope and light.","rarity":"Legendary","attack":23,"health":29,"specialAbility":"None"},{"id":"monster_ironfang_the_betrayer","name":"Ironfang the Betrayer","description":"Once a noble knight, now a cursed blade wielder.","rarity":"Legendary","attack":25,"health":26,"specialAbility":"None"},{"id":"monster_maelgrin_doomcaller","name":"Maelgrin Doomcaller","description":"A warlock who ended kingdoms.","rarity":"Legendary","attack":23,"health":29,"specialAbility":"None"},{"id":"monster_ashurak_the_wrathful","name":"Ashurak the Wrathful","description":"His roar levels cities.","rarity":"Legendary","attack":22,"health":29,"specialAbility":"None"},{"id":"monster_velmora_the_cruel","name":"Velmora the Cruel","description":"Queen of blades and blood.","rarity":"Legendary","attack":28,"health":28,"specialAbility":"None"},{"id":"monster_lich_king_final","name":"The Lich King","description":"His legend silences even the bravest.","rarity":"Legendary","attack":26,"health":39,"specialAbility":"None"}]');var l=(e=>(e.Ordinary="Ordinary",e.Common="Common",e.Uncommon="Uncommon",e.Rare="Rare",e.Epic="Epic",e.Legendary="Legendary",e))(l||{}),_=(e=>(e.None="None",e.Taunt="Taunt",e.DualStrike="DualStrike",e.Healer="Healer",e))(_||{});const d={Legendary:0,Epic:1,Rare:2,Uncommon:3,Common:4,Ordinary:5},c={Legendary:12,Epic:8,Rare:5,Uncommon:3,Common:2,Ordinary:1},h={Ordinary:"#bbbbbb",Common:"#cccccc",Uncommon:"#279f27",Rare:"#3399ff",Epic:"#aa00ff",Legendary:"#ffaa00"};var g=(e=>(e.Random="Random",e.Boss="Boss",e.Miniboss="Miniboss",e.FixedMob="FixedMob",e))(g||{}),u=(e=>(e.Front="Front",e.Back="Back",e))(u||{});class p{constructor(){t(this,"cards"),this.cards=i.map((e=>({...e,rarity:l[e.rarity],specialAbility:_[e.specialAbility]})))}getById(e){return this.cards.find((t=>t.id===e))}getAll(){return[...this.cards]}getUsedCardCost(e){let t=0;for(const s of e){const e=this.getById(s);e&&(t+=c[e.rarity])}return t}getMaxCardCost(e){const t=Math.max(1,Math.min(e,50)),s=1/(1+Math.exp(-.16*(t-19))),n=1/(1+Math.exp(2.88)),r=5+(s-n)/(1/(1+Math.exp(-4.96))-n)*55;return Math.round(r)}isValidCardSelection(e,t){const s=this.getMaxCardCost(e);return t.reduce(((e,t)=>e+c[t.rarity]),0)<=s}playerHasEligibleCardDrops(e){return this.cards.filter((t=>!e.includes(t.id))).length>0}getRandomCardsByRarity(e,t,s=[]){const n=this.cards.filter((t=>e.includes(t.rarity)&&!s.includes(t.id)));return Phaser.Utils.Array.Shuffle(n),n.slice(0,t)}getWeightedRandomCardDrop(e,t){const s={[l.Ordinary]:230,[l.Common]:220,[l.Uncommon]:200,[l.Rare]:140,[l.Epic]:110,[l.Legendary]:100},n={[l.Ordinary]:0,[l.Common]:0,[l.Uncommon]:4,[l.Rare]:8,[l.Epic]:18,[l.Legendary]:30},r={[l.Ordinary]:[],[l.Common]:[],[l.Uncommon]:[],[l.Rare]:[],[l.Epic]:[],[l.Legendary]:[]};for(const l of this.cards)e.includes(l.id)||r[l.rarity].push(l);const o=[];for(const c of Object.values(l))t>=n[c]&&r[c].length>0&&o.push({rarity:c,weight:s[c]});if(0===o.length)return null;const a=o.reduce(((e,t)=>e+t.weight),0),i=Math.random()*a;let m=0,_=o[0].rarity;for(const{rarity:l,weight:c}of o)if(m+=c,i<=m){_=l;break}const d=r[_];return Phaser.Utils.Array.GetRandom(d)}}const b=JSON.parse('[{"stageNumber":1,"title":"Chapter 1: The Farm - Stage 1","image":"farm-field.jpg","description":"Our farmhand receives an unexpected royal summons.","story":[{"name":"Narrator","lines":"The sun dipped low over the golden fields, casting long shadows across rows of wheat. A young farmhand named Caelan stood at the edge of the family land, wiping sweat from their brow, unaware that fate was already galloping toward them.","image":""},{"name":"Narrator","lines":"From the dirt path beyond the scarecrow-strewn fence came a rider clad in emerald and silver, the royal colors of King Alaric\'s court. The rider dismounted, bearing a scroll bound with wax and bearing the King\'s seal.","image":""},{"name":"Stranger","lines":"You are Caelan of the West Vale?","image":"stranger"},{"name":"Caelan","lines":"I am","image":"caelan"},{"name":"Stranger","lines":"I have a message for you from the King.","image":"stranger"},{"name":"Narrator","lines":"The royal messenger hands you a scroll sealed with wax.","image":""},{"name":"Narrator","lines":"The scroll trembles in your hands as you break the seal. “Your blood bears the mark of the gods,” it read. “Destiny calls you to rescue the Princess from the evil Lich King.”","image":""},{"name":"Narrator","lines":"The next morning, Caelan gathered together a group of friends and headed out from the farm. The journey would span forests thick with wolves, mountains haunted by spirits, and deserts scorched by fire. But the message was clear-they were the last descendant of the Old Gods, and the world once again needed their power.","image":""}],"steps":[{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_bandit_thug"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_bandit_thug"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_bandit_thug"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_lizardkin_scout","monster_moss_golem","monster_bandit_thug"]},{"type":"miniboss","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_bandit_thug"]}]},{"stageNumber":2,"title":"Chapter 1: The Farm - Stage 2","image":"farm-field-buildings.jpg","description":"Caelan and friends leave the familiar fields behind as rumors of prowling beasts spread.","story":[{"name":"Narrator","lines":"As the village winds faded behind them, Caelan glanced back one final time at the only home they had ever known. In the silence of departure, the fields seemed to whisper of a past now out of reach.","image":""},{"name":"Garrick","lines":"You sure about this? Leaving everything behind for a dream in a letter?","image":"garrick"},{"name":"Caelan","lines":"It\'s not just a dream. It\'s a call. If we don\'t go, who will?","image":"caelan"},{"name":"Narrator","lines":"The road ahead twisted through wind-swept pastures and overgrown trails. But something was wrong. The animals were uneasy, and old farmers spoke of shadows stealing livestock under moonlight.","image":""}],"steps":[{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_lizardkin_scout","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_lizardkin_scout","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_lizardkin_scout","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_lizardkin_scout","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"miniboss","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_lizardkin_scout","monster_shadow_rat","monster_moss_golem"]}]},{"stageNumber":3,"title":"Chapter 1: The Farm - Stage 3","image":"farm-road.jpg","description":"An ambush in the barley fields threatens to end the journey before it begins.","story":[{"name":"Narrator","lines":"The group took a shortcut through a barley field, hoping to avoid the main road. The air was thick with the scent of grain and unease.","image":""},{"name":"Elira","lines":"Shh... did you hear that? Rustling to the north.","image":"elira"},{"name":"Narrator","lines":"Before they could react, shadows burst from the crop. Gnolls and goblins - too many for mere coincidence.","image":""},{"name":"Caelan","lines":"This wasn\'t random. Someone sent them. Hold the line!","image":"caelan"}],"steps":[{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_lizardkin_scout","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lizardkin_scout","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lizardkin_scout","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lizardkin_scout","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"miniboss","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_lizardkin_scout","monster_moss_golem"]}]},{"stageNumber":4,"title":"Chapter 1: The Farm - Stage 4","image":"farm-woods-edge.jpg","description":"At the edge of the farmland, ancient stone ruins whisper secrets of Caelan\'s heritage.","story":[{"name":"Narrator","lines":"They reached a crumbling ruin where the farm met the wild woods. Vines choked broken stone etched with unfamiliar runes.","image":""},{"name":"Elira","lines":"These stones are... older than the Kingdom. Look-this symbol. The same as on your scroll, Caelan.","image":"elira"},{"name":"Narrator","lines":"As the sun set, a chill swept in. The ruins trembled. From the shadows came creatures twisted by old magic-guardians of something long forgotten.","image":""},{"name":"Caelan","lines":"They\'re not here by chance. The Old Gods... left warnings.","image":"caelan"}],"steps":[{"type":"random","enemies":["monster_goblin_scout","monster_lizardkin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lizardkin_scout","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_lizardkin_scout","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_lizardkin_scout","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"miniboss","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_lizardkin_scout","monster_moss_golem"]}]},{"stageNumber":5,"title":"Chapter 1: The Farm - Stage 5","image":"farm-forest-border.jpg","description":"A hobgoblin warlord blocks the final gate out of the farmland. A first true test of steel and spirit.","story":[{"name":"Narrator","lines":"At the boundary fence where the farm met the woods, a crude palisade had been raised. Smoke rose from campfires. A warband had made camp.","image":""},{"name":"Caelan","lines":"We can\'t go around. This is their checkpoint. We go through-or turn back.","image":"caelan"},{"name":"Warlord Brakka","lines":"No one leaves the vale without my mark. And my mark... is death.","image":"monster_hobgoblin"},{"name":"Narrator","lines":"The hobgoblin known as Brakka was a brute even among his kind. Flanked by goblins and gnolls, he raised a warhammer carved with bones. The first true battle had begun.","image":""}],"steps":[{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_lizardkin_scout","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"boss","enemies":["monster_hobgoblin","monster_goblin_scout","monster_gnoll_grunt","monster_bandit_thug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]}]},{"stageNumber":6,"title":"Chapter 2: The Woods - Stage 1","image":"forest-path.jpg","description":"The group steps into the Witherwood, where the air is heavy with enchantment and the trees whisper ancient curses.","story":[{"name":"Narrator","lines":"The moment their feet crossed the threshold into the Witherwood, the air thickened. Light seemed to dim, though the sky remained clear.","image":""},{"name":"Elira","lines":"The trees here are wrong. I can feel something watching... everywhere.","image":"elira"},{"name":"Caelan","lines":"This is where the map goes silent. We\'ll need to trust our instincts now.","image":"caelan"},{"name":"Narrator","lines":"Half-seen shadows flickered in the distance, and paths twisted when no one was looking. This was no ordinary forest.","image":""}],"steps":[{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"miniboss","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]}]},{"stageNumber":7,"title":"Chapter 2: The Woods - Stage 2","image":"forest-clearing.jpg","description":"An eerie clearing reveals a forgotten shrine to a goddess of dusk. The ground is littered with bones.","story":[{"name":"Narrator","lines":"In a quiet clearing, moss-covered stones formed a crude circle. At the center: a broken statue, half-buried and weeping dark sap.","image":""},{"name":"Caelan","lines":"Is this... a shrine? But to what?","image":"caelan"},{"name":"Elira","lines":"The Lady of Dusk. My grandmother used to whisper prayers to her when lightning storms came.","image":"elira"},{"name":"Narrator","lines":"Bones surrounded the altar-animal, goblin, human. Something still claimed tribute here.","image":""}],"steps":[{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_swamp_rat","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_swamp_rat","monster_wolves","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_slime","monster_wolves","monster_feral_dog","monster_swamp_rat","monster_lurking_thief","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_swamp_rat","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_swamp_rat","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]}]},{"stageNumber":8,"title":"Chapter 2: The Woods - Stage 3","image":"forest-marsh.jpg","description":"The woods turn to bog as mists rise and illusions test the group\'s resolve.","story":[{"name":"Narrator","lines":"The path descended into mist-covered bogland. Sounds were muffled, shapes distorted. Every step threatened to drag them under.","image":""},{"name":"Caelan","lines":"Did you see that? A woman in red just beyond those trees. Then-gone.","image":"caelan"},{"name":"Garrick","lines":"I saw my mother. She died five winters ago. That wasn\'t real, was it?","image":"garrick"},{"name":"Narrator","lines":"The forest here didn\'t just deceive the eyes-it hunted the mind. Phantasms rose from the fog, echoing the party\'s darkest memories.","image":""}],"steps":[{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_swamp_rat","monster_shadow_rat","monster_slime","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_swamp_rat","monster_slime","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_slime","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_swamp_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider","monster_swamp_rat"]},{"type":"miniboss","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider","monster_swamp_rat"]}]},{"stageNumber":9,"title":"Chapter 2: The Woods - Stage 4","image":"forest-ancient-tree.jpg","description":"They reach the heart of the Witherwood: a colossal tree grown around a ruin. Something stirs beneath the roots.","story":[{"name":"Narrator","lines":"A giant oak loomed, wider than a cottage and tall as a keep. Its roots had grown through broken stone steps and shattered arches.","image":""},{"name":"Elira","lines":"These ruins are elven. Old elven. Before the Sundering.","image":"elira"},{"name":"Caelan","lines":"Do you feel that hum? Like... something breathing. Beneath us.","image":"caelan"},{"name":"Narrator","lines":"Suddenly, rot burst from the roots-animated husks of long-dead forest guardians, corrupted by centuries of decay.","image":""}],"steps":[{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_slime","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_swamp_rat","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_slime","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_swamp_rat","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_slime","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_swamp_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_slime","monster_swamp_rat","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_slime","monster_swamp_rat","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]}]},{"stageNumber":10,"title":"Chapter 2: The Woods - Stage 5","image":"forest-foggy-clearing.jpg","description":"A corrupted forest spirit reveals itself, guarding the only safe path out of the Witherwood.","story":[{"name":"Narrator","lines":"In the thickest part of the forest, the fog parted around a perfect circle of mushrooms and thorns. In the center hovered a being once divine-now decayed.","image":""},{"name":"Elira","lines":"That... was a forest guardian. But something\'s poisoned it.","image":"elira"},{"name":"Corrupted Sylvana","lines":"You do not belong here, mortals. This realm is mine again. You will not leave with your minds... or your lives.","image":"sylvana"},{"name":"Caelan","lines":"This spirit guards the threshold. If we fall here, the forest keeps us. Stand firm!","image":"caelan"}],"steps":[{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_slime","monster_swamp_rat","monster_shadow_rat","monster_moss_golem"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_slime","monster_swamp_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_feral_dog","monster_lurking_thief","monster_slime","monster_shadow_rat","monster_moss_golem","monster_swamp_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_wolves","monster_slime","monster_feral_dog","monster_swamp_rat","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]},{"type":"boss","enemies":["monster_corrupted_sylvana","monster_cave_bat","monster_forest_spider","monster_torch_bug","monster_swamp_rat","monster_wolves","monster_feral_dog","monster_slime","monster_lurking_thief","monster_shadow_rat","monster_moss_golem","monster_venom_spider"]}]},{"stageNumber":11,"title":"Chapter 3: The Hills - Stage 1","image":"hills-overlook.jpg","description":"Leaving the forest behind, the party climbs into the rugged highlands. The wind howls with voices that don\'t belong to the living.","story":[{"name":"Narrator","lines":"With the cursed forest behind them, Caelan\'s party entered a land of cold stone and wide skies. The hills rolled like waves - each peak hiding secrets.","image":""},{"name":"Elira","lines":"The wind speaks in the old tongue... I don\'t like it.","image":"elira"},{"name":"Garrick","lines":"These hills were once battlefields. The dead remember.","image":"garrick"},{"name":"Narrator","lines":"The path ahead forked between cairns marked by broken blades. None felt welcome.","image":""}],"steps":[{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]}]},{"stageNumber":12,"title":"Chapter 3: The Hills - Stage 2","image":"hill-cairns.jpg","description":"They stumble upon a grave field where ancient warriors once clashed. The dead do not rest easily here.","story":[{"name":"Narrator","lines":"An eerie hush fell over a field of ancient burial cairns. Dozens of them, each crowned with rusted helms and blackened spears.","image":""},{"name":"Elira","lines":"These are war graves... this was a massacre site.","image":"elira"},{"name":"Caelan","lines":"Then tread lightly. Disturb nothing. Take only our memories, and-","image":"caelan"},{"name":"Narrator","lines":"A spectral horn blew in the distance. The cairns began to shift.","image":""}],"steps":[{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_bog_hag","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_bog_hag","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_bog_hag","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_bone_crawler","monster_dire_wolf","monster_bog_hag","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]}]},{"stageNumber":13,"title":"Chapter 3: The Hills - Stage 3","image":"hill-canyon.jpg","description":"A narrow gorge offers shelter from the wind - and the perfect place for an ambush.","story":[{"name":"Narrator","lines":"The wind died down as they descended into a rocky gorge. Walls rose steep on either side, and their footsteps echoed too loudly.","image":""},{"name":"Garrick","lines":"I don\'t like this. Nowhere to run. Nowhere to flank.","image":"garrick"},{"name":"Elira","lines":"It\'s too quiet. Something\'s wrong-","image":"elira"},{"name":"Narrator","lines":"Raiders burst from the shadows, painted in blood and ash, blades drawn. They didn\'t want coin. They wanted a kill.","image":""}],"steps":[{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_bog_hag","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_bog_hag","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_bog_hag","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_bog_hag","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_bog_hag","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]}]},{"stageNumber":14,"title":"Chapter 3: The Hills - Stage 4","image":"hill-ancient-wall.jpg","description":"They find a crumbling stone wall - the remnants of a long-fallen kingdom. Something stirs behind the stones.","story":[{"name":"Narrator","lines":"Massive blocks of stone jutted from the hillside - the skeletal remains of a forgotten citadel. Moss crept through runes carved in a dead language.","image":""},{"name":"Caelan","lines":"These aren\'t just ruins. This was a fortress... guarding something.","image":"caelan"},{"name":"Elira","lines":"The earth here is cursed. I feel pain... grief... rage trapped under the stones.","image":"elira"},{"name":"Narrator","lines":"From beneath the wall, armored skeletons rose - their eyes glowing with hate centuries old.","image":""}],"steps":[{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_bog_hag","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_bog_hag","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_bog_hag","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_bog_hag","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"miniboss","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_bog_hag","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]}]},{"stageNumber":15,"title":"Chapter 3: The Hills - Stage 5","image":"hill-storm.jpg","description":"A brutal storm crashes through the hills - and with it comes a legendary warrior long believed to be dead.","story":[{"name":"Narrator","lines":"Black clouds rolled in unnaturally fast. Lightning struck the hills, and with each flash, a ghostly figure stood atop a stone mound - closer with every strike.","image":""},{"name":"Elira","lines":"That\'s no living man. That\'s the Stormbound General. He died a hundred years ago.","image":"elira"},{"name":"Caelan","lines":"Then why is he drawing his blade now?","image":"caelan"},{"name":"Stormbound General","lines":"I fell with honor... but no peace. You trespass upon my tomb, and now you\'ll lie beside me.","image":"stormbound_general"}],"steps":[{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_bog_hag","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_bog_hag","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_bog_hag","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"random","enemies":["monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_bog_hag","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]},{"type":"boss","enemies":["monster_stormbound_general","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_feral_dog","monster_bog_hag","monster_lurking_thief","monster_shadow_rat","monster_venom_spider"]}]},{"stageNumber":16,"title":"Chapter 4: The Forgotten Road - Stage 1","image":"cracked-road.jpg","description":"The remnants of an imperial road stretch before the party - shattered stone lined with dead trees and forgotten bones.","story":[{"name":"Narrator","lines":"What once was a mighty road of trade and glory now lay cracked and overgrown. Roots burst through stone like the earth reclaiming its due.","image":""},{"name":"Caelan","lines":"This road led to the capital of the old empire. Nothing\'s traveled it in years.","image":"caelan"},{"name":"Garrick","lines":"Nothing living, maybe. But plenty of things still watch from the ruins.","image":"garrick"}],"steps":[{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"miniboss","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]}]},{"stageNumber":17,"title":"Chapter 4: The Forgotten Road - Stage 2","image":"collapsed-bridge.jpg","description":"A collapsed bridge spans a dry riverbed. Crossing it draws the attention of something that does not belong in the mortal world.","story":[{"name":"Narrator","lines":"The bridge groaned under their weight, even though much of it had long since fallen. Shadows moved below... though no water flowed.","image":""},{"name":"Elira","lines":"There\'s... something below us. It sees us.","image":"elira"},{"name":"Caelan","lines":"We move fast, or we fall with the stones.","image":"caelan"},{"name":"Narrator","lines":"The dead beneath the bridge rose to meet them - still shackled to the stone in undeath.","image":""}],"steps":[{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"miniboss","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]}]},{"stageNumber":18,"title":"Chapter 4: The Forgotten Road - Stage 3","image":"abandoned-village.jpg","description":"The road passes through a dead village. Doors hang open, but nothing moves. That is, until night falls.","story":[{"name":"Narrator","lines":"The village had no name, only memories. Homes stood hollowed by fire and time. Yet not a single corpse remained.","image":""},{"name":"Garrick","lines":"This wasn\'t abandoned. It was purged.","image":"garrick"},{"name":"Elira","lines":"There\'s magic here. I feel a ritual burned into the stones.","image":"elira"},{"name":"Narrator","lines":"As night fell, glowing eyes filled the windows. The village\'s former residents had never left.","image":""}],"steps":[{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"miniboss","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]}]},{"stageNumber":19,"title":"Chapter 4: The Forgotten Road - Stage 4","image":"broken-statue.jpg","description":"Statues of ancient emperors line the road - each shattered, each face defaced. One remains intact... and it breathes.","story":[{"name":"Narrator","lines":"The statue watched from the roadside. Long ago, they glorified forgotten rulers - now they stood like silent mourners.","image":""},{"name":"Caelan","lines":"These weren\'t toppled by war. This was deliberate. A cleansing of history.","image":"caelan"},{"name":"Elira","lines":"One still stands... and it\'s watching us.","image":"elira"},{"name":"Narrator","lines":"The last statue opened its stone eyes and stepped from its pedestal, sword raised in eternal defense.","image":""}],"steps":[{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"miniboss","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]}]},{"stageNumber":20,"title":"Chapter 4: The Forgotten Road - Stage 5","image":"sunken-temple.jpg","description":"The road ends at a broken temple, clinging to the mountainside. Inside, a heretic prince still guards the old empire\'s final secret.","story":[{"name":"Narrator","lines":"The path curved into a wide crater where a sunken temple lay beneath tangled roots and cracked stone. It whispered of betrayal.","image":""},{"name":"Elira","lines":"This temple was dedicated to the sun... but something dark has claimed it now.","image":"elira"},{"name":"Caelan","lines":"Someone\'s inside. I feel it. He\'s been waiting.","image":"caelan"},{"name":"Heretic Prince","lines":"The empire fell, and I remain. I am its last son - its executioner. You will not pass.","image":"heretic_prince"}],"steps":[{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"random","enemies":["monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]},{"type":"boss","enemies":["monster_heretic_prince","monster_zombie","monster_bone_crawler","monster_dire_wolf","monster_skeleton","monster_ghoul","monster_wight","monster_tomb_guardian","monster_grave_robber","monster_bandit_leader","monster_troll_spawn","monster_stone_golem"]}]},{"stageNumber":21,"title":"Chapter 5: The Wastelands - Stage 1","image":"blighted-plains.jpg","description":"The fertile earth gives way to blackened dust and skeletal trees. The wind tastes of ash. The Wastelands begin.","story":[{"name":"Narrator","lines":"The sky dimmed as if choked by unseen smoke. The Wastelands stretched before them - a dead land where nothing thrived.","image":""},{"name":"Caelan","lines":"This place was razed in the First War. The ground never recovered.","image":"caelan"},{"name":"Elira","lines":"Magic clings here, but it\'s wrong. Poisoned. Every step burns.","image":"elira"},{"name":"Narrator","lines":"The dust stirred... and the cursed remnants of the war stirred with it.","image":""}],"steps":[{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"miniboss","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]}]},{"stageNumber":22,"title":"Chapter 5: The Wastelands - Stage 2","image":"ashen-fissure.jpg","description":"A deep fissure cuts across the land. Crossing it requires passing over a brittle, bone-laced bridge watched by unseen eyes.","story":[{"name":"Narrator","lines":"The ground split like a scar across the world. A narrow bridge of bone and ash spanned the chasm, creaking with every step.","image":""},{"name":"Garrick","lines":"That\'s not stone holding that together. That\'s skulls... and something\'s watching us from below.","image":"garrick"},{"name":"Narrator","lines":"From the depths of the fissure, the dead began to crawl forth, unwilling to let them pass.","image":""}],"steps":[{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"miniboss","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]}]},{"stageNumber":23,"title":"Chapter 5: The Wastelands - Stage 3","image":"corrupted-oasis.jpg","description":"An oasis appears amidst the ruin, impossibly green. But the water is black and the trees whisper lies.","story":[{"name":"Narrator","lines":"In the heart of the blight, green shimmered. Trees, flowers, water - untouched. But the smell was wrong. Too sweet. Too still.","image":""},{"name":"Elira","lines":"Illusion. No... worse. It\'s real, but corrupted. Something is feeding on us.","image":"elira"},{"name":"Caelan","lines":"We burn it down, or it consumes us.","image":"caelan"},{"name":"Narrator","lines":"The trees screamed as they burned. And from the dark water came those who had drunk the poison... and changed.","image":""}],"steps":[{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"miniboss","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]}]},{"stageNumber":24,"title":"Chapter 5: The Wastelands - Stage 4","image":"ruined-outpost.jpg","description":"A ruined watchtower offers brief shelter. Inside, forgotten soldiers still stand guard - unaware they died long ago.","story":[{"name":"Narrator","lines":"The tower leaned, held together by spite and memory. Banners of a fallen kingdom fluttered in the dead air.","image":""},{"name":"Caelan","lines":"This was a border post. These men defended the realm once...","image":"caelan"},{"name":"Narrator","lines":"The sound of armor creaked from within. Dust-covered soldiers turned hollow eyes toward the intruders - blades raised.","image":""}],"steps":[{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"miniboss","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]}]},{"stageNumber":25,"title":"Chapter 5: The Wastelands - Stage 5","image":"black-spire.jpg","description":"At the edge of the world rises the Black Spire, a monument of bone and hatred. Its guardian has stood for centuries - and never once fallen.","story":[{"name":"Narrator","lines":"The Black Spire tore at the sky, made of fused bones and cursed stone. The wind carried screams that never ceased.","image":""},{"name":"Elira","lines":"This is a waygate. It leads deeper. The Lich King\'s true domain lies beyond.","image":"elira"},{"name":"Garrick","lines":"And something\'s guarding it. I can hear its breath. Still alive after all these years?","image":"garrick"},{"name":"Narrator","lines":"A knight clad in tarnished obsidian plate emerged. His oath unbroken. His soul bound. He would not let them pass.","image":""}],"steps":[{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"random","enemies":["monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]},{"type":"boss","enemies":["monster_obsidian_knight","monster_imp","monster_dust_wraith","monster_carrion_drake","monster_flame_wisp","monster_dark_acolyte","monster_minotaur","monster_nightmare_steed","monster_blade_dancer","monster_voidcaller","monster_abyssal_spawn"]}]},{"stageNumber":26,"title":"Chapter 6: The Bleeding Crags - Stage 1","image":"crimson-cliffs.jpg","description":"The ground turns jagged, veins of red stone pulsing like a heartbeat beneath the earth. You\'ve entered the Bleeding Crags.","story":[{"name":"Narrator","lines":"The cliffs bled. Not metaphorically - red ichor oozed from cracks in the rock. The ground pulsed like something alive... or dying.","image":""},{"name":"Elira","lines":"This place was a temple once. Now it\'s a wound - kept open by ritual and sacrifice.","image":"elira"},{"name":"Caelan","lines":"I don\'t care what gods they served. We close this wound.","image":"caelan"},{"name":"Narrator","lines":"The stone responded - birthing guardians made of blood and rage.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":27,"title":"Chapter 6: The Bleeding Crags - Stage 2","image":"shrine-of-screams.jpg","description":"An ancient shrine stands defiled - once a place of healing, now echoing with the cries of blood offerings.","story":[{"name":"Narrator","lines":"Cracked statues and broken altars lined the shrine, their eyes weeping rust. The air was thick with pain.","image":""},{"name":"Garrick","lines":"The rocks are screaming. You hear that? They\'re not just cursed - they remember.","image":"garrick"},{"name":"Elira","lines":"They made pacts here... old ones. And someone\'s keeping them alive.","image":"elira"},{"name":"Narrator","lines":"The blood priests emerged, masked in flesh, knives singing with hunger.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":28,"title":"Chapter 6: The Bleeding Crags - Stage 3","image":"bone-ledges.jpg","description":"The path narrows to knife-edged ledges, where the wind howls with lost voices and skeletal remains stir underfoot.","story":[{"name":"Narrator","lines":"Bones littered the narrow trail, pressed into the rock as though swallowed by the mountain. Something moved beneath the surface.","image":""},{"name":"Caelan","lines":"These weren\'t warriors. They were sacrifices. Executed to feed the stone.","image":"caelan"},{"name":"Narrator","lines":"The mountain heaved. From cracks in the path, twisted remnants clawed their way out - failed offerings that still hungered.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":29,"title":"Chapter 6: The Bleeding Crags - Stage 4","image":"ritual-pit.jpg","description":"A massive pit glows with crimson runes. Echoes of chants and screams spill from below. A ritual is underway.","story":[{"name":"Narrator","lines":"Deep within the Crags, the ritual pit boiled with blood and fire. Runes danced across the walls, old magic bound in pain.","image":""},{"name":"Elira","lines":"They\'re calling something. If we let it finish, the Wastelands will spread.","image":"elira"},{"name":"Garrick","lines":"Then we crash the ceremony.","image":"garrick"},{"name":"Narrator","lines":"Chanting stopped. The pit hissed. And from its heart rose creatures formed from ritual sacrifice itself.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":30,"title":"Chapter 6: The Bleeding Crags - Stage 5","image":"throne-of-veins.jpg","description":"At the peak lies the Throne of Veins - a grotesque altar where the Blood Queen waits. She bleeds, and the world bleeds with her.","story":[{"name":"Narrator","lines":"A monstrous throne sculpted from veins, flesh, and bone loomed before them. Upon it sat the Blood Queen - mother of rituals, priestess of decay.","image":""},{"name":"Elira","lines":"She\'s not mortal. Not anymore. Her magic twists life itself.","image":"elira"},{"name":"Caelan","lines":"Then we cut her from the mountain and watch it bleed out.","image":"caelan"},{"name":"Narrator","lines":"The Blood Queen rose, bleeding from every pore. The mountain shuddered - her children stirred - and battle was joined.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"boss","enemies":["monster_blood_queen","monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":31,"title":"Chapter 7: The Glass Wastes - Stage 1","image":"shattered-dunes.jpg","description":"Sand becomes glass underfoot. Shards of reality reflect not just light, but memory. The Glass Wastes begin.","story":[{"name":"Narrator","lines":"The dunes shimmered like broken mirrors. The wind didn\'t howl - it whispered voices from other times.","image":""},{"name":"Caelan","lines":"This place was destroyed by magic. Nothing here is stable - not even time.","image":"caelan"},{"name":"Elira","lines":"I see echoes of people who never lived. They\'re walking... beside us.","image":"elira"},{"name":"Narrator","lines":"Shards rose into shapes, mimicking warriors of the past - crystalized memories turned hostile.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":32,"title":"Chapter 7: The Glass Wastes - Stage 2","image":"fractured-temple.jpg","description":"A once-great temple lies splintered in the sands - fragments of its time scattered across reality.","story":[{"name":"Narrator","lines":"The temple had no center. Its pieces floated, suspended in fractured time. Every step was a gamble against entropy.","image":""},{"name":"Garrick","lines":"I just saw myself die. Three steps ahead. Don\'t ask.","image":"garrick"},{"name":"Elira","lines":"These distortions... they\'re feeding something. A being that lives between seconds.","image":"elira"},{"name":"Narrator","lines":"Mirage guardians stepped from frozen echoes - glass helms, sandsteel blades, and no shadows beneath them.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":33,"title":"Chapter 7: The Glass Wastes - Stage 3","image":"crystal-canyon.jpg","description":"The canyon walls pulse with prismatic light, refracting moments you haven\'t lived. Something is watching through the shards.","story":[{"name":"Narrator","lines":"Each canyon wall held glimpses of other paths - victories, failures, lives unlived. A thousand possibilities, none real.","image":""},{"name":"Caelan","lines":"If I hesitate... I become one of them. A reflection. A ghost of a choice I didn\'t make.","image":"caelan"},{"name":"Elira","lines":"The echoes are sentient. Some... remember being real.","image":"elira"},{"name":"Narrator","lines":"Time phantoms erupted from the canyon - each a distorted version of something you once were... or might become.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":34,"title":"Chapter 7: The Glass Wastes - Stage 4","image":"sunken-refraction.jpg","description":"Beneath a shifting dune lies a city trapped in a time loop. It restarts every hour, unaware of its own doom.","story":[{"name":"Narrator","lines":"The sunken city breathed in loops. Every hour, it collapsed - and rose again. Citizens screamed, rebuilt, forgot. Endlessly.","image":""},{"name":"Garrick","lines":"They\'re not alive. But they don\'t know that.","image":"garrick"},{"name":"Elira","lines":"A Chronarch is buried here. Its anchor holds this nightmare together. Break it - or be caught in the loop forever.","image":"elira"},{"name":"Narrator","lines":"The loop resisted - unleashing its guardians made of frozen moments and burning sand.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":35,"title":"Chapter 7: The Glass Wastes - Stage 5","image":"heart-of-glass.jpg","description":"In the heart of the Wastes rises a crystalline tower. At its peak, the Chronarch awaits - master of fractured time.","story":[{"name":"Narrator","lines":"The tower shimmered out of sync with the world. Inside, each floor was a different year. Reality frayed at the edges.","image":""},{"name":"Elira","lines":"He\'s not bound by time. He *is* time. Or what\'s left of it.","image":"elira"},{"name":"Caelan","lines":"Then we unmake the clock. Let the Wastes collapse behind us.","image":"caelan"},{"name":"Narrator","lines":"The Chronarch descended - a being of glass and starlight. With every blow, the world cracked a little more.","image":""}],"steps":[{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"boss","enemies":["monster_chronarch","monster_necromancer","monster_flame_elemental","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":36,"title":"Chapter 8: The Silent Deep - Stage 1","image":"descent-chasm.jpg","description":"The sky vanishes. You descend into the earth\'s breathless core, past roots older than nations and echoes older than time.","story":[{"name":"Narrator","lines":"The light thinned, the air thickened. What began as a cave became a wound in the world - leading only down.","image":""},{"name":"Caelan","lines":"There\'s no wind... no life. Even magic feels muted.","image":"caelan"},{"name":"Elira","lines":"This isn\'t a cave. It\'s a grave for things too dangerous to burn or bury.","image":"elira"},{"name":"Narrator","lines":"Movement. Shadows writhing on the walls - not from your torchlight. Something else moves here, unseen.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"miniboss","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]}]},{"stageNumber":37,"title":"Chapter 8: The Silent Deep - Stage 2","image":"fungal-sanctum.jpg","description":"A forest of bioluminescent fungi pulses with sickly light. It breathes. And it\'s watching.","story":[{"name":"Narrator","lines":"The chamber pulsed like a lung. Spores hung thick in the air. The ground squelched underfoot.","image":""},{"name":"Elira","lines":"These spores... they think. They remember. They\'re trying to *speak* to me.","image":"elira"},{"name":"Garrick","lines":"Then stop listening. We don\'t need another parasite in our heads.","image":"garrick"},{"name":"Narrator","lines":"From beneath the glowing stalks, creatures rose - part man, part fungus, all wrong.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"miniboss","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]}]},{"stageNumber":38,"title":"Chapter 8: The Silent Deep - Stage 3","image":"underground-river.jpg","description":"A river of black water flows through a tomb of bones. The ferry waits - but the price is not coin.","story":[{"name":"Narrator","lines":"The river hissed, refusing to reflect anything real. The ferry awaited - its pilot eyeless, mouthless, timeless.","image":""},{"name":"Caelan","lines":"He wants... memories. Yours. Mine. Whoever rides forgets who they were.","image":"caelan"},{"name":"Elira","lines":"Then we fight the river. We *become* the price.","image":"elira"},{"name":"Narrator","lines":"Something old stirred beneath the water - guardians of memory, protectors of the toll.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"miniboss","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]}]},{"stageNumber":39,"title":"Chapter 8: The Silent Deep - Stage 4","image":"forgotten-vaults.jpg","description":"Doors sealed with runes older than empires creak open. Inside - the lost knowledge of ancient gods, and the things that guard it.","story":[{"name":"Narrator","lines":"The vaults hissed open like lungs exhaling dust. Each chamber held a truth too heavy for sane minds.","image":""},{"name":"Elira","lines":"This is where the old gods buried their shame.","image":"elira"},{"name":"Caelan","lines":"These guards aren\'t beasts. They\'re ideas... made flesh.","image":"caelan"},{"name":"Narrator","lines":"Concepts clawed into being: guilt, hunger, silence, regret. And they *hated* the living.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"miniboss","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]}]},{"stageNumber":40,"title":"Chapter 8: The Silent Deep - Stage 5","image":"abyssal-core.jpg","description":"At the deepest point lies a throne of black stone - and the Watcher Below, an ancient horror sealed in dreamless sleep.","story":[{"name":"Narrator","lines":"No footsteps echoed here. Sound died before it reached your ears. And in the center of nothing... it slept.","image":""},{"name":"Elira","lines":"The Watcher... it doesn\'t dream. It waits. And it *knows* we\'re here.","image":"elira"},{"name":"Garrick","lines":"We end this now. Before it remembers how to wake up.","image":"garrick"},{"name":"Narrator","lines":"The Watcher rose, bones of obsidian and eyes of void. Its scream birthed silence.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]},{"type":"boss","enemies":["monster_onyx_gargantuan","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_abyssal_spawn","monster_bone_colossus","monster_runebound_construct"]}]},{"stageNumber":41,"title":"Chapter 9: The Blighted Reach - Stage 1","image":"withered-plain.jpg","description":"You emerge into a broken world. The sky bleeds violet, and the ground cracks with every step. Life has fled - or become something worse.","story":[{"name":"Narrator","lines":"The land here screams in silence. Trees twist into gallows. Rivers run backward. Nothing is as it should be.","image":""},{"name":"Elira","lines":"This is where the Lich King\'s shadow first touched the world. Everything it touched died - and stayed.","image":"elira"},{"name":"Caelan","lines":"No... not died. *Changed*. This place remembers pain.","image":"caelan"},{"name":"Narrator","lines":"From the hollowed earth, blighted forms crawl, pulled by strings of forgotten sorrow.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_balgrim_the_vile","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":42,"title":"Chapter 9: The Blighted Reach - Stage 2","image":"field-of-hollows.jpg","description":"Once a city, now a graveyard. The spirits here wear the faces of your loved ones - and they want you to stay.","story":[{"name":"Narrator","lines":"Empty houses stared back at you, windows like dead eyes. The streets whispered old names... yours among them.","image":""},{"name":"Caelan","lines":"I see... my brother. But he died years ago. This is a trap.","image":"caelan"},{"name":"Elira","lines":"They\'re echoes - stolen from us. The Lich King uses our grief against us.","image":"elira"},{"name":"Narrator","lines":"Phantoms emerged, each one a twisted memory, fighting not to destroy you - but to make you *forget* yourself.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_zarael_the_flameborn","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":43,"title":"Chapter 9: The Blighted Reach - Stage 3","image":"twisted-forest.jpg","description":"A forest petrified mid-scream. Branches like claws. Roots like veins. And things that hunt without eyes.","story":[{"name":"Narrator","lines":"The trees grew in unnatural shapes, each one grasping at the sky that had long since turned away.","image":""},{"name":"Garrick","lines":"This place doesn\'t want us dead. It wants us *twisted*. Like them.","image":"garrick"},{"name":"Elira","lines":"The forest watches. Every step we take becomes harder. The roots... they feed on our doubt.","image":"elira"},{"name":"Narrator","lines":"With a sound like tearing skin, the forest let loose its guardians - beasts carved from rot and sorrow.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_thornshade_the_eternal","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":44,"title":"Chapter 9: The Blighted Reach - Stage 4","image":"corrupted-shrine.jpg","description":"A holy site, long defiled. Black flames flicker where once stood candles of prayer. Something still lingers within the sanctum.","story":[{"name":"Narrator","lines":"The shrine stank of old blood and rotting faith. Its idols wept tar. The stones themselves recoiled from your presence.","image":""},{"name":"Elira","lines":"This was sacred once. The corruption runs deepest where the light once burned brightest.","image":"elira"},{"name":"Caelan","lines":"A guardian remains... not loyal, not alive - but bound.","image":"caelan"},{"name":"Narrator","lines":"A corrupted seraph stepped forward - wings burned away, voice broken by countless betrayals. It would not let you pass.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_korthax_the_unchained","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":45,"title":"Chapter 9: The Blighted Reach - Stage 5","image":"throne-of-roots.jpg","description":"At the center of the Blight lies the Heartroot, pulsing with stolen souls. Its guardian: a creature birthed of the Lich King\'s first sin.","story":[{"name":"Narrator","lines":"You came upon a vast open pit - at its center, the Heartroot pulsed, each throb leaking black mist into the skies.","image":""},{"name":"Elira","lines":"That\'s no natural heart... it\'s a prison for thousands of souls. And it\'s *awake*.","image":"elira"},{"name":"Caelan","lines":"The Guardian knows we\'re here. It was made to stop us - and it won\'t stop bleeding until we do.","image":"caelan"},{"name":"Narrator","lines":"From within the roots, something massive stirred - not beast, not god, but something far worse: a mistake made manifest.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]},{"type":"miniboss","enemies":["monster_xalzaroth","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus"]}]},{"stageNumber":46,"title":"Chapter 10: The Throne of Ash - Stage 1","image":"ashen-gate.jpg","description":"At the edge of the broken world stands a gate forged from bone and sorrow. It only opens for those who carry both.","story":[{"name":"Narrator","lines":"The Ashen Gate loomed like a wound torn in the sky. Glyphs bled fire. Screams echoed from within.","image":""},{"name":"Garrick","lines":"Once we cross, there\'s no turning back. This gate opens *into* death, not out of it.","image":"garrick"},{"name":"Elira","lines":"Then we bring life into it. Or we leave nothing behind.","image":"elira"},{"name":"Narrator","lines":"From the gate\'s shadows, twisted sentinels rose - former heroes, now enslaved to undeath.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"boss","enemies":["monster_ironfang_the_betrayer","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]}]},{"stageNumber":47,"title":"Chapter 10: The Throne of Ash - Stage 2","image":"hall-of-echoes.jpg","description":"An endless hall of obsidian mirrors reflects not your form - but your failures. Here, the mind breaks before the body.","story":[{"name":"Narrator","lines":"Each step echoed a thousand regrets. The mirrors whispered your worst fears back at you... in your own voice.","image":""},{"name":"Caelan","lines":"They show me when I fled... when I failed. They want me to kneel before I ever see him.","image":"caelan"},{"name":"Elira","lines":"We all carry shadows. But they do not own us.","image":"elira"},{"name":"Narrator","lines":"Illusions coalesced into deadly forms - figments given hunger by the Lich King\'s will.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"boss","enemies":["monster_maelgrin_doomcaller","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]}]},{"stageNumber":48,"title":"Chapter 10: The Throne of Ash - Stage 3","image":"vault-of-bones.jpg","description":"Pyramids of skulls, rivers of marrow. The Vault of Bones stores the essence of every soul the Lich King has devoured.","story":[{"name":"Narrator","lines":"You passed through corridors built from the dead. Faces frozen in agony stared from the walls.","image":""},{"name":"Elira","lines":"He feeds on them... even now. The princess is among them - I can feel her cry out.","image":"elira"},{"name":"Caelan","lines":"Then we carve our way through. For her. For all of them.","image":"caelan"},{"name":"Narrator","lines":"The dead stirred - not mindless, but *bound*. They begged for release with every strike.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"boss","enemies":["monster_ashurak_the_wrathful","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]}]},{"stageNumber":49,"title":"Chapter 10: The Throne of Ash - Stage 4","image":"crown-of-black-flame.jpg","description":"Before the throne lies the Crown of Black Flame - a sentient inferno, loyal only to its master.","story":[{"name":"Narrator","lines":"Black fire rose in a dome before the final ascent. It laughed without sound, hungry for defiance.","image":""},{"name":"Garrick","lines":"That... thing. It\'s not just fire. It\'s hatred. A crown forged from his first war.","image":"garrick"},{"name":"Elira","lines":"We snuff it out - or it becomes *our* crown.","image":"elira"},{"name":"Narrator","lines":"The flames formed into knights of ash and shadow. The Crown would not surrender its place without a final inferno.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"boss","enemies":["monster_velmora_the_cruel","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]}]},{"stageNumber":50,"title":"Chapter 10: The Throne of Ash - Final Battle","image":"lich-king-throne.jpg","description":"At last, the Throne. The princess is bound in chains of grief. The Lich King rises, eyes burning with the end of all things.","story":[{"name":"Narrator","lines":"The throne was carved from the corpses of kings. Upon it sat the Lich King, cloaked in despair, crowned by eternity.","image":""},{"name":"Lich King","lines":"You have come far, little lights. But light cannot survive where time has died.","image":"lich_king"},{"name":"Elira","lines":"You fear the light because it remembers who you once were. We will *remind* you.","image":"elira"},{"name":"Narrator","lines":"The final battle began - soul against shadow, memory against oblivion. The fate of the world burned between them.","image":""}],"steps":[{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"random","enemies":["monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]},{"type":"boss","enemies":["monster_lich_king_final","monster_abyssal_crawler","monster_void_tunneler","monster_fungal_colossus","monster_stone_maw_basilisk","monster_voidcaller","monster_bone_colossus","monster_runebound_construct","monster_dracolich","monster_lich","monster_storm_revenant","monster_fire_troll","monster_phoenix_warden","monster_bone_colossus","monster_obsidian_knight"]}]}]'),f=class e{constructor(){t(this,"_stages",null)}static get instance(){return this._instance||(this._instance=new e),this._instance}get stages(){return this._stages||(this._stages=this.loadStageData()),this._stages}loadStageData(){return b.map((e=>({...e,steps:e.steps.map((e=>{const t=e.type.charAt(0).toUpperCase()+e.type.slice(1).toLowerCase();return{...e,type:g[t]}}))})))}getTotalStepCount(){return this.stages.reduce(((e,t)=>e+t.steps.length),0)}};t(f,"_instance");let y=f;const w="ccgPlayerData",k=class e{constructor(){t(this,"data");const e=localStorage.getItem(w),s=e?JSON.parse(e):this.createNewPlayer();s.settings??(s.settings={muteAll:!1,muteMusic:!1,muteSound:!1,musicVolume:.5,soundVolume:.9,vibration:!0}),this.data=this.createAutoSavingProxy(s)}static get instance(){return this._instance||(this._instance=new e),this._instance}saveToStorage(){try{localStorage.setItem(w,JSON.stringify(this.data))}catch(e){console.error("Failed to save player data:",e)}}createAutoSavingProxy(e,t=[]){const s=this;return new Proxy(e,{get(e,n){const r=e[n];return r&&"object"==typeof r?s.createAutoSavingProxy(r,[...t,n]):r},set:(e,t,n)=>(e[t]=n,s.saveToStorage(),!0),deleteProperty:(e,t)=>(delete e[t],s.saveToStorage(),!0)})}createNewPlayer(){const t={level:1,currentExp:0,expToNextLevel:e.getExpToNextLevel(1),collection:[],equippedCards:[],progress:{completedStages:[],currentStage:1,currentStep:0},settings:{muteAll:!1,muteMusic:!1,muteSound:!1,musicVolume:.5,soundVolume:.9,vibration:!0}},s=(new p).getRandomCardsByRarity([l.Ordinary],8);t.collection=s.map((e=>e.id));const n=Phaser.Utils.Array.Shuffle([...t.collection]);return t.equippedCards=n.slice(0,5),t}static getExpToNextLevel(e){return 100+Math.round(5*Math.pow(e,.8))}grantExp(t){const{currentStage:s,currentStep:n}=this.data.progress,r=5*(s-1)+n,o=y.instance.getTotalStepCount();let a=Math.round(10+50*Math.pow(r/o,.85));for(t&&(a*=1.5),this.data.currentExp+=a,this.data.expToNextLevel-=a;this.data.expToNextLevel<=0&&this.data.level<50;)this.data.level++,this.data.expToNextLevel=e.getExpToNextLevel(this.data.level)}newGame(){this.data=this.createNewPlayer()}};t(k,"_instance");let v=k;const S={music:null,tempSounds:[]};let C=!1;function x(e){S.currentScene=e,C||(C=!0,e.sound.once(o.Sound.Events.UNLOCKED,(()=>{S.music&&!S.music.isPlaying&&S.music.play()})),e.game.events.on(o.Core.Events.BLUR,(()=>A())),document.addEventListener("visibilitychange",(()=>{document.hidden&&A()})),e.events.on("shutdown",(()=>{!function(){const e=S.currentScene;e&&(S.tempSounds.forEach((t=>{t.isPlaying&&t.stop(),e.sound.remove(t),t.destroy()})),S.tempSounds=[])}()})))}function A(){var e;const t=S.currentScene;t&&(t.scene.isActive("paused")||((null==(e=S.music)?void 0:e.isPlaying)&&(S.music.pause(),S.wasPlaying=!0),t.scene.isActive(t.scene.key)&&t.scene.pause(t.scene.key),t.scene.run("paused",{onResume:()=>{t.scene.stop("paused"),t.scene.resume(t.scene.key),S.music&&S.wasPlaying&&(S.music.resume(),S.wasPlaying=!1)}})))}function N(e,t,s=1){if(v.instance.data.settings.muteAll||v.instance.data.settings.muteSound)return;const n=e.sound.add(t,{volume:s*v.instance.data.settings.soundVolume});S.tempSounds.push(n),n.once("complete",(()=>{z(e,n)})),n.once("stop",(()=>{z(e,n)})),n.play()}function T(e,t){var s,n,r;v.instance.data.settings.muteAll||v.instance.data.settings.muteMusic||(null==(s=S.music)?void 0:s.isPlaying)&&S.music.key===t||(S.currentScene=e,(null==(n=S.tween)?void 0:n.isPlaying())&&S.tween.stop(),(null==(r=S.music)?void 0:r.isPlaying)?(S.pendingKey=t,S.tween=e.tweens.add({targets:S.music,volume:0,duration:1e3,onComplete:()=>{if(S.music&&(S.music.stop(),e.sound.remove(S.music),S.music.destroy(),S.music=null),S.pendingKey){const t=S.pendingKey;S.pendingKey=void 0,M(e,t)}}})):M(e,t))}function M(e,t){const s=e.sound.add(t,{loop:!0,volume:0});S.music=s,e.sound.locked?e.sound.once(o.Sound.Events.UNLOCKED,(()=>{s.play()})):s.play(),S.tween=e.tweens.add({targets:s,volume:v.instance.data.settings.musicVolume,duration:1e3})}function z(e,t){t.isPlaying&&t.stop(),e.sound.remove(t),t.destroy();const s=S.tempSounds.indexOf(t);-1!==s&&S.tempSounds.splice(s,1)}function I(){S.music&&(v.instance.data.settings.muteAll||v.instance.data.settings.muteMusic||0===v.instance.data.settings.musicVolume?S.music.isPlaying&&S.music.stop():(S.music.isPlaying||S.music.play({loop:!0}),S.music.setVolume(v.instance.data.settings.musicVolume).setVolume(v.instance.data.settings.musicVolume)))}class E extends o.Scene{constructor(e){super(e),t(this,"contentContainer"),t(this,"baseWidth",720),t(this,"baseHeight",1280)}create(){this.contentContainer=this.add.container(0,0),this.scaleContent(),this.scale.on("resize",this.scaleContent,this),this.input.on("pointerdown",(()=>{N(this,"click"),v.instance.data.settings.vibration&&navigator.vibrate&&navigator.vibrate(10)}))}scaleContent(){const{width:e,height:t}=this.scale.gameSize,s=e/this.baseWidth,n=t/this.baseHeight,r=Math.min(s,n);this.contentContainer.setScale(r);const o=(e-this.baseWidth*r)/2,a=(t-this.baseHeight*r)/2;this.contentContainer.setPosition(o,a)}}function B(e,t,s,n,r,o=20,a=30){const i=e.add.text(0,0,n,{fontFamily:"Cinzel",fontSize:`${o}px`,color:"#ffffff"}).setOrigin(.5),m=i.width+2*a,l=i.height+a,_=e.make.container({x:t,y:s,add:!1}),d=e.add.rectangle(0,0,m,l,2763306).setOrigin(.5),c=e.add.graphics();c.lineStyle(1,16766720),c.strokeRect(-m/2+5,-l/2+5,m-10,l-10);const h=e.add.rectangle(0,0,m,l).setOrigin(.5).setStrokeStyle(2,16777130).setVisible(!1),g=e.add.zone(0,0,m,l).setOrigin(.5,.5).setSize(m,l).setInteractive({useHandCursor:!0});return g.on("pointerover",(()=>{h.setVisible(!0),i.setColor("#ffffaa")})),g.on("pointerout",(()=>{h.setVisible(!1),i.setColor("#ffffff")})),g.on("pointerdown",(()=>{N(e,"click"),r()})),_.add([d,c,h,i,g]),e.contentContainer.add(_),_}function D(e,t,s,n,r,o=32,a=30){const i=e.add.text(0,0,n,{fontFamily:"Cinzel",fontSize:`${o}px`,color:"#ffffff",align:"center"}).setOrigin(.5),m=i.width+2*a,l=i.height+a,_=e.add.graphics(),d=[new Phaser.Geom.Point(-m/2+20,-l/2),new Phaser.Geom.Point(m/2,-l/2),new Phaser.Geom.Point(m/2-20,l/2),new Phaser.Geom.Point(-m/2,l/2)];_.fillStyle(3355443,1),_.fillPoints(d,!0);const c=e.add.graphics(),h=[new Phaser.Geom.Point(-m/2+20+5,-l/2+5),new Phaser.Geom.Point(m/2-5,-l/2+5),new Phaser.Geom.Point(m/2-20-5,l/2-5),new Phaser.Geom.Point(-m/2+5,l/2-5)];c.lineStyle(1,16763904,1),c.strokePoints(h,!0);const g=e.add.graphics();g.fillStyle(16777130,.1),g.fillPoints(d,!0),g.setVisible(!1);const u=e.add.zone(0,0,m,l).setOrigin(.5).setInteractive({useHandCursor:!0});u.on("pointerover",(()=>g.setVisible(!0))),u.on("pointerout",(()=>g.setVisible(!1))),u.on("pointerdown",(()=>{N(e,"click"),r()}));const p=e.make.container({x:t,y:s,add:!1});return p.add([_,c,g,i,u]),e.contentContainer.add(p),p}function O(e,t,s,n,r=32,o=20){const a=.65,i=e.add.text(0,0,n,{fontFamily:"Cinzel",fontSize:`${r}px`,color:"#ffffff",align:"center"}).setOrigin(.5).setAlpha(a),m=i.width+2*o,l=i.height+o,_=e.add.graphics(),d=[new Phaser.Geom.Point(-m/2+20,-l/2),new Phaser.Geom.Point(m/2,-l/2),new Phaser.Geom.Point(m/2-20,l/2),new Phaser.Geom.Point(-m/2,l/2)];_.fillStyle(3355443,a),_.fillPoints(d,!0);const c=e.add.graphics(),h=[new Phaser.Geom.Point(-m/2+20+5,-l/2+5),new Phaser.Geom.Point(m/2-5,-l/2+5),new Phaser.Geom.Point(m/2-20-5,l/2-5),new Phaser.Geom.Point(-m/2+5,l/2-5)];c.lineStyle(1,16763904,a),c.strokePoints(h,!0);const g=e.make.container({x:t,y:s,add:!1});return g.add([_,c,i]),e.contentContainer.add(g),g}function F(e){const t=y.instance.stages.length,s=v.instance.data.progress.currentStage,n=o.Math.Clamp(s/t,0,1),r=e.scale.width,a=e.scale.height-5,i=e.add.rectangle(0,a,r*n,5,16766720).setOrigin(0,0).setScrollFactor(0).setDepth(1e3),m=e.add.text(e.scale.width-30,20,"⚙️",{fontSize:"28px",color:"#ffffff"}).setOrigin(.5,0).setScrollFactor(0).setInteractive({useHandCursor:!0}).setDepth(1e3);m.on("pointerdown",(()=>{!function(e){const t=e.add.rectangle(e.scale.width/2,e.scale.height/2,300,280,0,.8).setStrokeStyle(1,16766720).setDepth(1001),s={fontSize:"16px",color:"#ffffff"},n={fontSize:"18px",color:"#FFD700"},r=[t];[{key:"muteAll",label:"Mute All"},{key:"muteMusic",label:"Mute Music"},{key:"muteSound",label:"Mute Sound"},{key:"vibration",label:"Vibration"}].forEach(((o,a)=>{const i=e.add.text(t.x-100,t.y-90+40*a,o.label,s).setOrigin(0,.5).setDepth(1001),m=e.add.text(t.x+60,t.y-90+40*a,v.instance.data.settings[o.key]?"ON":"OFF",n).setOrigin(0,.5).setInteractive({useHandCursor:!0}).setDepth(1001);m.on("pointerdown",(()=>{v.instance.data.settings[o.key]=!v.instance.data.settings[o.key],m.setText(v.instance.data.settings[o.key]?"ON":"OFF"),I()})),r.push(i,m)}));const o=e.add.text(t.x-100,t.y+70,"Music Vol",s).setOrigin(0,.5).setDepth(1001),a=e.add.text(t.x-100,t.y+110,"Sound Vol",s).setOrigin(0,.5).setDepth(1001),i=e.add.text(t.x+60,t.y+70,`${Math.round(100*v.instance.data.settings.musicVolume)}%`,n).setOrigin(0,.5).setDepth(1001).setInteractive({useHandCursor:!0}),m=e.add.text(t.x+60,t.y+110,`${Math.round(100*v.instance.data.settings.soundVolume)}%`,n).setOrigin(0,.5).setDepth(1001).setInteractive({useHandCursor:!0});i.on("pointerdown",(()=>{v.instance.data.settings.musicVolume=(v.instance.data.settings.musicVolume+.1)%1.1,i.setText(`${Math.round(100*v.instance.data.settings.musicVolume)}%`),I()})),m.on("pointerdown",(()=>{v.instance.data.settings.soundVolume=(v.instance.data.settings.soundVolume+.1)%1.1,m.setText(`${Math.round(100*v.instance.data.settings.soundVolume)}%`),I()})),r.push(o,a,i,m),t.setInteractive().on("pointerdown",(()=>{r.forEach((e=>e.destroy()))})),e.contentContainer.add(r)}(e)})),e.contentContainer.add([i,m])}const R={lastScene:""};function P(e,t,s,n,r=1,o=u.Front,a){const i=768*r,m=1024*r,_=e.add.container(s,n);if(_.setSize(i,m),o===u.Front){!function(e,t,s,n,r,o){const a=e.add.image(0,0,`${s.id}`).setOrigin(0).setDisplaySize(r*n,o*n);t.add(a),function(e,t,s,n){const r=80*n,o=80*n,a=Math.max(120*n,30),i=e.add.text(r,o,"⬟",{fontFamily:"Arial",fontSize:`${a}px`,fontStyle:"bold"}).setOrigin(.5);e.time.delayedCall(0,(()=>{G(i,h[s.rarity])})),t.add(i);const m=Math.max(70*n,14),l=e.add.text(r,o,c[s.rarity].toString(),{fontFamily:"Cinzel",fontSize:`${m}px`,fontStyle:"bold",color:"#111"}).setOrigin(.5);t.add(l)}(e,t,s,n),function(e,t,s,n){const r=function(e){switch(e){case l.Common:return 1;case l.Uncommon:return 2;case l.Rare:return 3;case l.Epic:return 4;case l.Legendary:return 5;default:return 1}}(s.rarity),o=80*n,a=Math.max(o,24);let i=(768*n-(r>0?a*r+-5*(r-1):0))/2+a/2;s.rarity!==l.Epic&&s.rarity!==l.Legendary||(i+=10);for(let m=0;m<r;m++){const n=e.add.text(i+m*(a+-5),0,"★︎",{fontSize:`${a}px`,color:h[s.rarity],fontFamily:"Arial"}).setOrigin(.5,0).setShadow(2,2,"#000000",2,!1,!0);t.add(n)}}(e,t,s,n),function(e,t,s,n,r){const o=64*n,a=Math.max(o,36),i=1024*n-a,m=Math.max(i,36),l=Math.max(40*n,12),_=e.add.graphics();_.fillStyle(0,.6),_.fillRect(0,m,r*n,a),t.add(_);const d=e.add.text(r*n/2,m+a/2,s.name,{fontFamily:"Cinzel",fontSize:`${l}px`,color:"#ffffff",align:"center",wordWrap:{width:r*n-40}}).setOrigin(.5);t.add(d)}(e,t,s,n,r),function(e,t,s,n){const r=Math.max(120*n,21),o=768*n-Math.max(80*n,12),a=1024*n-Math.max(80*n,12),i=e.add.text(o,a,"⛊",{fontFamily:"Arial",fontSize:`${r}px`,fontStyle:"bold",color:"#000"}).setOrigin(.5);e.time.delayedCall(0,(()=>{G(i,"#627d4d")})),t.add(i);const m=Math.max(70*n,15),l=e.add.text(o,a,s.attack.toString(),{fontFamily:"Cinzel",fontSize:`${m}px`,fontStyle:"bold",color:"#fff"}).setOrigin(.5);t.add(l)}(e,t,s,n),function(e,t,s,n){const r=80*n,o=1024*n-Math.max(80*n,12),a=Math.max(120*n,21),i=e.add.text(r,o,"❤",{fontFamily:"Arial",fontSize:`${a}px`,fontStyle:"bold",color:"#000000"}).setOrigin(.5);e.time.delayedCall(0,(()=>{G(i,"#ea2803")})),t.add(i);const m=Math.max(70*n,14),l=e.add.text(r,o,s.health.toString(),{fontFamily:"Cinzel",fontSize:`${m}px`,fontStyle:"bold",color:"#fff"}).setOrigin(.5);t.add(l)}(e,t,s,n),function(e,t,s,n,r,o,a){const i=e.add.graphics();i.lineStyle(2,parseInt(h[a].replace("#",""),16)),i.strokeRoundedRect(0,0,768*s,1024*s,6),t.add(i)}(e,t,n,0,0,0,s.rarity)}(e,_,t,r,768,1024);const s=1*m,n=8421504,o=e.add.rectangle(0,s,i,m-s,n,.7).setOrigin(0).setVisible(!0);o.name="healthOverlay",_.add(o)}else{const t=e.add.image(0,0,"card_back").setOrigin(0).setDisplaySize(i,m);_.add(t)}if(a){const t=e.add.rectangle(0,0,i,m).setOrigin(0).setInteractive({useHandCursor:!0}).setVisible(!0);t.on("pointerdown",(()=>{a()})),_.add(t)}return _.name=t.id,_}function H(e,t=100){const s=e.getByName("healthOverlay");if(!s)return;const n=e.height-e.height*(t/100);s.height=n,s.y=e.height-n,s.fillColor=3355443}function L(e,t,s,n=1){return`rgba(${e},${t},${s},${n})`}function W(e,t){return L(Math.max(0,e.r-255*t),Math.max(0,e.g-255*t),Math.max(0,e.b-255*t))}function G(e,t){const s=e.canvas.getContext("2d"),n=e.width,r=function(e){e=e.replace("#","");const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}(t),o=(a=r,L(Math.min(255,a.r+102),Math.min(255,a.g+102),Math.min(255,a.b+102)));var a;const i=L(r.r,r.g,r.b),m=W(r,.2),l=W(r,.05),_=s.createLinearGradient(0,0,n,0);_.addColorStop(0,o),_.addColorStop(.5,i),_.addColorStop(.51,m),_.addColorStop(1,l),e.setFill(_)}class j{constructor(){t(this,"cards"),this.cards=m.map((e=>({...e,rarity:l[e.rarity],specialAbility:_[e.specialAbility]})))}getById(e){return this.cards.find((t=>t.id===e))}getAll(){return[...this.cards]}getRandomCardsByRarity(e,t,s=[]){const n=this.cards.filter((t=>t.rarity===e&&!s.includes(t.id)));return Phaser.Utils.Array.Shuffle(n),n.slice(0,t)}getRandomMonstersFromList(e,t=5){const s=[],n=this.shuffleArray([...e]);for(let r=0;r<t&&n.length>0;r++){const e=Phaser.Math.Between(0,n.length-1),t=n.splice(e,1)[0],r=this.cards.find((e=>e.id===t));r&&s.push({...r})}return s}shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}}const U=()=>{var e;const t=.5625;let s=window.innerWidth,n=(null==(e=window.visualViewport)?void 0:e.height)||window.innerHeight;return s/n>t?s=n*t:n=s/t,{width:s,height:n}},{width:V,height:q}=U(),$={type:Phaser.AUTO,width:V,height:q,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:720,height:1280},parent:"game-container",backgroundColor:"#000000",scene:[a,class extends E{constructor(){super("Preloader")}init(){const e=this.cameras.main.width/2,t=this.cameras.main.height/2;this.add.rectangle(e,t,this.cameras.main.width,this.cameras.main.height,0);const s=this.add.rectangle(e,t,468,32);s.setStrokeStyle(2,16777215);const n=this.add.rectangle(e-234,t,1,28,16777215);n.setOrigin(0,.5);const r=this.add.text(e,t+32,"0%",{fontSize:"18px",color:"#ffffff"}).setOrigin(.5,0);this.load.on("progress",(e=>{n.width=28+440*e,r.setText(Math.round(100*e)+"%")})),this.load.on("complete",(()=>{r.destroy(),n.destroy(),s.destroy()}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.image("sublogo","sublogo.png"),this.load.image("bg_main","backgrounds/menu.jpg"),i.forEach((e=>{this.load.image(`${e.id}`,`cards/${e.id}.jpg`)})),m.forEach((e=>{this.load.image(`${e.id}`,`monsters/${e.id}.jpg`)})),this.load.image("card_back","ui/card-back.jpg"),this.load.image("card-back-adventure","ui/card-back-adventure.jpg"),this.load.image("card_selection","ui/card-back-selection.jpg"),this.load.image("card_continue","ui/card_continue.jpg"),this.load.image("card_battle","ui/card_battle.jpg"),this.load.image("card_drop","ui/card_drop.jpg"),this.load.image("deck-builder","backgrounds/deck-builder.jpg"),this.load.image("scratch","ui/scratch.png"),this.load.image("star","ui/11571051.png"),this.load.image("confetti","ui/confetti.png"),this.load.audio("click","sfx/button-click-289742.mp3"),this.load.audio("foot","sfx/st2-footstep-sfx-323055.mp3"),this.load.audio("horn","sfx/relaxing-music-original-viking-attacking-battle-horn-116623.mp3"),this.load.audio("fanfare","sfx/success-fanfare-trumpets-6185.mp3"),this.load.audio("punch","sfx/punch-140236.mp3"),this.load.audio("swordhit","sfx/hit-swing-sword-small-2-95566.mp3"),this.load.audio("scratch","sfx/paper-rip-fast-252617.mp3"),this.load.audio("title","sfx/music-intro.mp3"),this.load.audio("battle","sfx/music-battle.mp3"),this.load.audio("bossbattle","sfx/music-boss-battle.mp3"),this.load.audio("defeat","sfx/music-defeat.mp3"),this.load.audio("victory","sfx/music-victory.mp3"),this.load.audio("music_stage_1","sfx/music_stage_1.mp3"),this.load.audio("music_stage_2","sfx/music_stage_2.mp3"),this.load.audio("music_stage_3","sfx/music_stage_3.mp3"),this.load.audio("music_stage_4","sfx/music_stage_4.mp3"),this.load.audio("music_stage_5","sfx/music_stage_5.mp3"),this.load.audio("music_stage_6","sfx/music_stage_6.mp3"),this.load.audio("music_stage_7","sfx/music_stage_7.mp3"),this.load.audio("music_stage_8","sfx/music_stage_8.mp3"),this.load.audio("music_stage_9","sfx/music_stage_9.mp3"),this.load.audio("music_stage_10","sfx/music_stage_10.mp3")}async create(){super.create(),await this.loadWebFont("Cinzel","https://fonts.gstatic.com/s/cinzel/v25/8vIJ7ww63mVu7gt79mT7.woff2"),await this.loadWebFont("Trade Winds","https://fonts.gstatic.com/s/tradewinds/v17/AYCPpXPpYNIIT7h8-QenM0Jt5vM.woff2"),this.scene.start("MainMenuScene")}async loadWebFont(e,t){const s=new FontFace(e,"url("+t+")");try{const e=await s.load();document.fonts.add(e),await document.fonts.ready}catch(n){console.warn(`Failed to load font ${e}`,n)}}},class extends E{constructor(){super("MainMenuScene"),t(this,"logo"),t(this,"sublogo")}create(){super.create();const e=this.add.image(this.scale.width/2,this.scale.height/2,"bg_main").setDisplaySize(this.scale.width,this.scale.height).setAlpha(0);this.contentContainer.add(e),F(this),x(this),T(this,"title"),this.tweens.add({targets:e,alpha:1,duration:1e3,onComplete:()=>this.showLogo()})}showLogo(){this.logo=this.add.image(this.scale.width/2,200,"logo").setAlpha(0).setScale(.8).setOrigin(.5),this.sublogo=this.add.image(this.scale.width/2,350,"sublogo").setAlpha(0).setOrigin(.5),this.tweens.add({targets:this.logo,alpha:1,duration:1e3,onComplete:()=>this.showButton()}),this.tweens.add({targets:this.sublogo,alpha:1,duration:1e3}),this.contentContainer.add([this.logo,this.sublogo])}showButton(){const e=this.scale.width/2,t=.5*this.scale.height;if(1==v.instance.data.progress.currentStage&&0==v.instance.data.progress.currentStep)B(this,e,t,"Start Adventure",(()=>{this.navigate("AdventureScene")}),30),B(this,e,t+80,"How to Play",(()=>{this.navigate("HowToPlayScene")}),30);else{v.instance.data.progress.currentStage>50?B(this,e,t,"New Game",(()=>{v.instance.newGame(),this.scene.restart()}),30):B(this,e,t,"Continue Adventure",(()=>{this.navigate("AdventureScene")}),30);const{stage:s,stepIndex:n}=this.getRandomPastStep();B(this,e,t+80,"Random Battle",(()=>{this.navigate("CombatScene",{random:!0,stageId:s.stageNumber,stepId:n})}),30),B(this,e,t+160,"Collection",(()=>{this.navigate("CollectionScene")}),30),B(this,e,t+240,"How to Play",(()=>{this.navigate("HowToPlayScene")}),30)}}getRandomPastStep(){const e=v.instance.data.progress.currentStage,t=v.instance.data.progress.currentStep,s=y.instance.stages,n=[];for(const r of s)if(r.stageNumber<e)for(let e=0;e<r.steps.length;e++)n.push({stage:r,stepIndex:e});else if(r.stageNumber===e)for(let e=0;e<t;e++)n.push({stage:r,stepIndex:e});if(0===n.length)throw new Error("No eligible past steps found.");return o.Utils.Array.GetRandom(n)}navigate(e,t){this.scene.start(e,t)}},class extends E{constructor(){super("AdventureScene"),t(this,"bg"),t(this,"stagesInChapter",5),t(this,"visibleStageRange",{start:1,end:this.stagesInChapter}),t(this,"stages",[])}async preload(){this.stages=y.instance.stages;const e=`bg_stage_${Math.floor((v.instance.data.progress.currentStage-1)/this.stagesInChapter)+1}`;this.load.image(e,`assets/backgrounds/chapters/${e}.jpg`)}create(){super.create(),x(this);const e=Math.floor((v.instance.data.progress.currentStage-1)/this.stagesInChapter)+1,t=`bg_stage_${e}`,s=`music_stage_${e}`;this.bg=this.add.image(0,0,t).setOrigin(0,0),this.contentContainer.add(this.bg),this.visibleStageRange.start=(e-1)*this.stagesInChapter+1,this.visibleStageRange.end=Math.min(this.visibleStageRange.start+this.stagesInChapter-1,this.stages.length),T(this,s),this.setBackgroundPosition(),this.placeStageMarkers(),this.addDeckBuilderButton(),this.addMainMenuButton(),F(this)}getCurrentStage(){return v.instance.data.progress.currentStage}setBackgroundPosition(){this.bg.setScale(1);const e=this.scale.width/this.bg.width;this.bg.setScale(e);const t=this.bg.height*e-this.scale.height,s=this.visibleStageRange.start,n=this.visibleStageRange.end-s,r=t*(1-(v.instance.data.progress.currentStage-s)/n*.9);this.bg.setY(-r)}placeStageMarkers(){const e=this.visibleStageRange.end-this.visibleStageRange.start+1,t=this.scale.height/(e+1),s=this.scale.height-t-100;for(let n=this.visibleStageRange.start;n<=this.visibleStageRange.end;n++){const e=n-this.visibleStageRange.start,r=this.scale.width/2,o=s-e*t,a=this.stages.find((e=>e.stageNumber===n));n===v.instance.data.progress.currentStage?D(this,r,o,a?a.title:`Stage ${n}`,(()=>{0==v.instance.data.progress.currentStep?this.scene.start("StoryScene"):this.scene.start("ExplorationScene")}),18,30):O(this,r,o,a?a.title:`Stage ${n}`,18,30)}}addDeckBuilderButton(){B(this,this.scale.width/2,this.scale.height-150,"Deck Builder",(()=>{this.scene.stop("AdventureScene"),R.lastScene=this.scene.key,this.scene.start("DeckBuilderScene")}))}addMainMenuButton(){B(this,this.scale.width/2,this.scale.height-80,"Main Menu",(()=>{this.scene.start("MainMenuScene")}))}},class extends E{constructor(){super("CombatScene"),t(this,"cardManager"),t(this,"monsterManager"),t(this,"playerCards",[]),t(this,"monsterCards",[]),t(this,"cardScale",.17),t(this,"currentStage"),t(this,"currentStep"),t(this,"stageId"),t(this,"stepId"),t(this,"stages"),t(this,"nextScene",""),t(this,"soundKeys",["punch","swordhit","scratch"])}init(e){this.stages=y.instance.stages,!0===e.random?(this.stageId=e.stageId,this.stepId=e.stepId,this.nextScene="MainMenuScene"):(this.stageId=v.instance.data.progress.currentStage,this.stepId=v.instance.data.progress.currentStep,this.nextScene=""),this.currentStage=this.stages.find((e=>e.stageNumber===this.stageId)),this.currentStep=JSON.parse(JSON.stringify(this.currentStage.steps[this.stepId]))}preload(){this.currentStage&&this.load.image(this.currentStage.image,`assets/backgrounds/stages/${this.currentStage.image}`)}create(){super.create(),this.monsterManager=new j,this.cardManager=new p,x(this),this.currentStep.type===g.Boss||this.currentStep.type===g.Miniboss?T(this,"bossbattle"):T(this,"battle");const e=this.add.image(0,0,this.currentStage.image).setOrigin(0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),t=this.add.text(20,this.scale.height-90,`Level: ${v.instance.data.level}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2),s=this.add.text(20,this.scale.height-70,`${this.currentStage.title}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2);this.contentContainer.add([e,t,s]);const n=this.scale.width/2;let r=140,o=[];if(this.currentStep.type==g.Boss){const e=this.currentStep.enemies.shift(),t=this.monsterManager.getById(e);o=this.monsterManager.getRandomMonstersFromList(this.currentStep.enemies,4),o.splice(2,0,t)}else{o=this.monsterManager.getRandomMonstersFromList(this.currentStep.enemies),o.sort(((e,t)=>{if(t.rarity!==e.rarity)return d[e.rarity]-d[t.rarity];const s=e.health+e.health;return t.attack+t.attack-s}));const e=o.shift();o=this.monsterManager.shuffleArray(o),o.splice(2,0,e)}let a=0;const i=this.currentStep.type===g.Boss||this.currentStep.type===g.Miniboss;let m=1;if(this.currentStage.stageNumber>=50&&(m=1.32),this.currentStage.stageNumber>=46?m=1.25:this.currentStage.stageNumber>20?m=1.12:this.currentStage.stageNumber<=10&&(m=.8),this.monsterCards=o.map(((e,t)=>{const s=i&&2===t,o=s?this.cardScale+.01:i?this.cardScale-.01:this.cardScale,d=n-2*r+t*r-65+a;e.health=Math.ceil(e.health*m),e.attack=Math.ceil(e.attack*m);const c=P(this,e,d,120,o,u.Front);return this.contentContainer.add(c),s&&(a=15),{id:e.id,name:e.name,sprite:c,baseAttack:e.attack,maxHealth:e.health,currentHealth:e.health,isPlayer:!1,specialAbility:_[e.specialAbility],rarity:l[e.rarity]}})),v.instance.data.level<50){const e=this.add.text(20,this.scale.height-50,`EXP to next level: ${v.instance.data.expToNextLevel}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2);this.contentContainer.add(e)}r=140,this.playerCards=v.instance.data.equippedCards.map(((e,t)=>{const s=this.cardManager.getById(e);if(s){const e=P(this,s,n-2*r+t*r-65,this.scale.height-300,this.cardScale,u.Front);return this.contentContainer.add(e),{id:s.id,name:s.name,sprite:e,baseAttack:s.attack,maxHealth:s.health,currentHealth:s.health,isPlayer:!0,specialAbility:_[s.specialAbility]}}})).filter((e=>void 0!==e)),F(this),this.showBattleIntroAnimation((()=>this.runCombatLoop()))}async runCombatLoop(){for(;this.playerCards.some((e=>e&&e.currentHealth>0))&&this.monsterCards.some((e=>e&&e.currentHealth>0));)await this.runCombatRound();this.playerCards.every((e=>!e||e.currentHealth<=0))?(T(this,"defeat"),this.showEndOverlay("defeat")):this.monsterCards.every((e=>!e||e.currentHealth<=0))&&(T(this,"victory"),this.showEndOverlay("victory"))}async runCombatRound(){for(let e=0;e<5;e++){const t=this.findNextAlive(e,this.playerCards);if(t){t.specialAbility===_.Healer&&this.applyHealing(this.playerCards,t);const s=t.specialAbility===_.DualStrike?2:1;for(let n=0;n<s;n++){const s=this.findNextAlive(e,this.monsterCards);if(s){const{damage:e,isCritical:n}=this.calculateDamage(t.baseAttack);s.currentHealth=Math.max(s.currentHealth-e,0);const r=s.currentHealth/s.maxHealth*100;await this.animateAttack(t,s,e,n,r)}}}const s=this.findNextAlive(e,this.monsterCards);if(s){const t=this.findNextAlive(e,this.playerCards);if(t){const{damage:e,isCritical:n}=this.calculateDamage(s.baseAttack,s.rarity);t.currentHealth=Math.max(t.currentHealth-e,0);const r=t.currentHealth/t.maxHealth*100;await this.animateAttack(s,t,e,n,r,!0)}}}}findNextAlive(e,t){const s=t.find((e=>e&&e.currentHealth>0&&e.specialAbility===_.Taunt));if(s)return s;const n=t.length;for(let r=e;r<n;r++){const e=t[r];if(e&&e.currentHealth>0)return e}for(let r=0;r<e;r++){const e=t[r];if(e&&e.currentHealth>0)return e}return null}calculateDamage(e,t){const s=Phaser.Math.FloatBetween(.9,1.1);let n=Phaser.Math.Between(1,20)<=2;(t&&t===l.Epic||t===l.Legendary)&&(n=Phaser.Math.Between(1,20)<=4);const r=n?1.25:1;return{damage:Math.round(e*s*r),isCritical:n}}applyHealing(e,t){const s=e.filter((e=>e&&e.currentHealth>0&&e.currentHealth<e.maxHealth));if(0===s.length)return;const{damage:n}=this.calculateDamage(t.baseAttack),r=Math.floor(n/s.length);for(const o of s)o.currentHealth=Math.min(o.currentHealth+r,o.maxHealth),H(o.sprite,o.currentHealth/o.maxHealth*100)}async animateAttack(e,t,s,n,r,o=!1){const a=e.sprite,i=t.sprite,m=a.scene,l=120,_=a.y,d=this.playerCards.includes(e)?-1:1,c=m.add.sprite(i.x,i.y,"scratch");c.setOrigin(.5,.5),c.setPosition(i.x+i.displayWidth/2,i.y+i.displayHeight/2),c.setAlpha(0),c.setDepth(i.depth+1),c.setScale(.01);const h=e=>new Promise((t=>{e.onComplete=()=>t(),m.tweens.add(e)}));await h({targets:a,y:_+100*d,duration:l,ease:"Power2"}),await h({targets:c,alpha:1,scale:i.displayWidth/c.width,duration:l,ease:"Power2"}),this.playRandomSound(),v.instance.data.settings.vibration&&navigator.vibrate&&o&&(r<=0?navigator.vibrate([100,250]):navigator.vibrate(100));const g=m.add.text(i.x+i.displayWidth/2,i.y+i.displayHeight/2,`-${s}`,{fontFamily:"Trade Winds",fontSize:"42px",color:n?"#ff4444":"#ffff00",fontStyle:n?"bold":"normal",stroke:"#000000",strokeThickness:3}).setOrigin(.5).setAlpha(0).setScale(.75).setDepth(101);if(m.tweens.add({targets:g,alpha:{from:0,to:1},y:g.y-20,scale:{from:.75,to:1},duration:200,ease:"Cubic.easeOut",onComplete:()=>{m.tweens.add({targets:g,alpha:0,duration:300,delay:300,onComplete:()=>g.destroy()})}}),n&&!this.playerCards.includes(e)){const e=m.add.rectangle(0,0,m.scale.width,m.scale.height,16711680,.65).setOrigin(0).setDepth(200);m.tweens.add({targets:e,alpha:{from:.65,to:0},duration:250,onComplete:()=>e.destroy()})}H(t.sprite,r);for(let p=0;p<4;p++)await h({targets:i,x:i.x+(p%2==0?10:-10),duration:15,yoyo:!0,ease:"Sine.easeInOut"});await h({targets:c,alpha:0,scale:i.displayWidth/c.width*1.5,duration:l,ease:"Power2"});const u=h({targets:a,y:_,duration:l,ease:"Power2"});c.destroy(),await u}showEndOverlay(e){const{width:t,height:s}=this.scale,n=this.add.rectangle(0,0,t,s,0,.8).setOrigin(0),r=this.add.text(t/2,s/2-120,"victory"===e?"Victory!":"Defeat",{fontFamily:"Cinzel, serif",fontSize:"48px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),o="victory"===e?"You've triumphed! Your tactics are improving. Press on to your next challenge!":"Your champions have fallen. Try playing your strongest cards and refining your deck in the builder. Use the random battle feature to build your deck.",a=this.add.text(t/2,s/2-40,o,{fontFamily:"Cinzel, serif",fontSize:"20px",color:"#dddddd",wordWrap:{width:.8*t}}).setOrigin(.5);if(this.contentContainer.add([n,r,a]),"victory"===e){let e=10;if(""!==this.nextScene&&(e=75),Phaser.Math.Between(1,100)<=e)return""==this.nextScene?(R.lastScene="ExplorationScene",v.instance.grantExp(!0),v.instance.data.progress.currentStep=v.instance.data.progress.currentStep+1,void this.navigate("CardDropScene")):(R.lastScene=this.nextScene,void this.navigate("CardDropScene"));""===this.nextScene?D(this,t/2,s/2+60,"Continue Adventure",(()=>{v.instance.grantExp(!0),v.instance.data.progress.currentStep=v.instance.data.progress.currentStep+1,this.navigate("ExplorationScene")})):D(this,t/2,s/2+60,"Continue",(()=>{this.navigate(this.nextScene)}))}else""===this.nextScene?(D(this,t/2,s/2+60,"Fight Again",(()=>{this.navigate("CombatScene")})),D(this,t/2,s/2+140,"Deck Builder",(()=>{R.lastScene=this.scene.key,this.navigate("DeckBuilderScene")})),D(this,t/2,s/2+220,"Main Menu",(()=>{R.lastScene=this.scene.key,this.navigate("MainMenuScene")}))):D(this,t/2,s/2+60,"Continue",(()=>{this.navigate(this.nextScene,{random:!0})}))}showBattleIntroAnimation(e){const{width:t,height:s}=this.cameras.main,n=this.add.rectangle(0,0,2*t,2*s,0).setOrigin(0).setDepth(1e3).setAlpha(1),r=this.add.text(t+200,s/2,"FIGHT!",{fontFamily:"Cinzel, serif",fontSize:"64px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5).setAlpha(0).setDepth(1001);this.contentContainer.add([n,r]),this.tweens.add({targets:n,alpha:1,duration:200,onComplete:()=>{this.tweens.add({targets:r,x:t/2,alpha:1,duration:600,ease:"Power2",onComplete:()=>{this.time.delayedCall(600,(()=>{this.tweens.add({targets:r,x:-200,alpha:0,duration:600,ease:"Power2"}),this.tweens.add({targets:n,alpha:0,duration:600,onComplete:()=>{n.destroy(),r.destroy(),e()}})}))}})}})}playRandomSound(){if(!this.soundKeys.length)return;const e=Phaser.Math.Between(0,this.soundKeys.length-1);N(this,this.soundKeys[e])}navigate(e,t){this.scene.start(e,t)}},class extends E{constructor(){super("DeckBuilderScene"),t(this,"cardManager"),t(this,"collectionCardsContainers",[]),t(this,"equippedGroup"),t(this,"collectionContainer"),t(this,"listBackground"),t(this,"maxEquippedCards",5),t(this,"isValidDeck",!1),t(this,"pointsText"),t(this,"scrollbar")}create(){super.create(),this.cardManager=new p;const e=this.add.image(0,0,"deck-builder").setOrigin(0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),t=this.add.rectangle(0,0,this.scale.width,this.scale.height,0,.4).setOrigin(0),s=this.add.text(this.scale.width/2,40,"Deck Builder",{fontFamily:"Cinzel",fontSize:"32px",color:"#fff"}).setOrigin(.5);this.contentContainer.add([e,t,s]),B(this,this.scale.width/2,this.scale.height-60,"Confirm Selection",(()=>{this.isValidDeck&&this.closeDeckBuilderScene()})),F(this),this.refreshUI()}renderEquippedCards(){this.equippedGroup&&this.equippedGroup.children&&this.equippedGroup.clear(!0,!0),this.equippedGroup=this.add.group();for(let e=0;e<this.maxEquippedCards;e++){const t=v.instance.data.equippedCards[e],s=t?this.cardManager.getById(t):{id:"",name:"Empty",rarity:l.Common,attack:0,health:0,specialAbility:_.None},n=t?u.Front:u.Back,r=P(this,s,20+140*e,80,.17,n,t?()=>{v.instance.data.equippedCards[e]="",this.refreshUI()}:void 0);this.equippedGroup.add(r)}}createCollectionList(){const e=320,t=this.scale.width-100,s=800;let n=this.collectionContainer?e-this.collectionContainer.y:0;this.collectionContainer&&this.collectionContainer.destroy(!0),this.scrollbar&&this.scrollbar.destroy();const r=this.add.graphics();r.fillRect(50,e,t,s);const a=r.createGeometryMask();this.listBackground||(this.listBackground=this.add.rectangle(40,310,t+20,820,0,.7).setOrigin(0).setName("listBackground")),this.collectionContainer=this.make.container({x:50,y:e,add:!1}),this.collectionContainer.setMask(a),this.collectionCardsContainers=[];let i=0;const m=()=>{i=o.Math.Clamp(i,0,Math.max(0,this.collectionContainer.height-s)),this.collectionContainer.y=e-i;const t=i/(this.collectionContainer.height-s);this.scrollbar.y=e+t*(s-this.scrollbar.displayHeight)};this.input.on("wheel",((e,t,s,n)=>{i+=n,m()}));let l=!1,_=0;this.input.on("pointerdown",(t=>{l=t.y>=e&&t.y<=1120,_=t.y})),this.input.on("pointermove",(e=>{if(!l||!e.isDown)return;const t=e.y-_;i-=t,m(),_=e.y})),this.input.on("pointerup",(()=>l=!1));let h=0;v.instance.data.collection.map((e=>this.cardManager.getById(e))).filter((e=>!!e)).sort(((e,t)=>{const s=d[e.rarity]-d[t.rarity];if(0!==s)return s;const n=c[t.rarity]-c[e.rarity];if(0!==n)return n;const r=e.attack+e.health;return t.attack+t.health-r})).forEach((e=>{const s=this.cardManager.getById(e.id);if(!s)return;const n=P(this,s,0,0,.15,u.Front,(()=>this.tryAddCard(e.id))),r=n.width+20,a=this.add.text(r,0,s.name,{fontSize:"20px",fontFamily:"Cinzel",color:"#ffffff"}).setOrigin(0,0),i=this.add.text(r,30,s.description||"No description",{fontSize:"16px",wordWrap:{width:t-r-20},color:"#cccccc"}).setOrigin(0,0),m=this.add.container(0,h,[n,a,i]);m.setSize(t,Math.max(n.height,i.y+i.height)),m.setInteractive(new o.Geom.Rectangle(0,0,m.width,m.height),o.Geom.Rectangle.Contains);const l=v.instance.data.equippedCards.includes(e.id),_=v.instance.data.equippedCards.filter((e=>""!==e)).length>=this.maxEquippedCards;l||_?m.setAlpha(.4):m.on("pointerdown",(()=>this.tryAddCard(e.id))),this.collectionContainer.add(m),this.collectionCardsContainers.push(m),h+=m.height+20})),this.collectionContainer.height=h;const g=Math.max(s/this.collectionContainer.height*s,20);this.scrollbar=this.add.rectangle(50+t-6,e,6,g,16777215,.4).setOrigin(0,0),i=o.Math.Clamp(n,0,Math.max(0,this.collectionContainer.height-s)),this.collectionContainer.y=e-i,this.contentContainer.add(this.collectionContainer),m()}tryAddCard(e){const t=this.cardManager.getMaxCardCost(v.instance.data.level);if(v.instance.data.equippedCards.filter((e=>""!==e)).length>=this.maxEquippedCards)return;if(v.instance.data.equippedCards.includes(e))return;const s=this.cardManager.getById(e);if(s&&!(v.instance.data.equippedCards.reduce(((e,t)=>{if(!t)return e;const s=this.cardManager.getById(t);return s?e+c[s.rarity]:e}),0)+c[s.rarity]>t)){for(let t=0;t<this.maxEquippedCards;t++)if(!v.instance.data.equippedCards[t]){v.instance.data.equippedCards[t]=e;break}this.refreshUI()}}refreshUI(){this.renderEquippedCards(),this.createCollectionList(),this.renderPlayerStats();const e=this.cardManager.getMaxCardCost(v.instance.data.level),t=v.instance.data.equippedCards.reduce(((e,t)=>{if(!t)return e;const s=this.cardManager.getById(t);return s?e+c[s.rarity]:e}),0),s=v.instance.data.equippedCards.filter((e=>""!==e)).length;this.isValidDeck=s===this.maxEquippedCards&&t<=e}closeDeckBuilderScene(){this.scene.stop("DeckBuilderScene"),R.lastScene&&this.scene.start(R.lastScene)}renderPlayerStats(){const e=this.cardManager.getMaxCardCost(v.instance.data.level),t=e-v.instance.data.equippedCards.reduce(((e,t)=>{if(!t)return e;const s=this.cardManager.getById(t);return s?e+c[s.rarity]:e}),0);this.pointsText&&this.pointsText.destroy(!0);const s=this.pointsText=this.add.text(this.scale.width/2,280,`Available Points: ${t}/${e}`,{fontSize:"20px",fontFamily:"Cinzel",color:"#ffffff"}).setOrigin(.5);this.contentContainer.add(s)}},class extends E{constructor(){super("CardDropScene")}preload(){this.load.image("bg_drop","assets/backgrounds/drop.jpg")}create(){super.create();const e=new p;x(this);var t=e.getWeightedRandomCardDrop(v.instance.data.collection,v.instance.data.level);if(t){v.instance.data.collection.push(t.id),N(this,"fanfare");const e=this.add.image(this.scale.width/2,this.scale.height/2,"bg_drop").setDisplaySize(this.scale.width,this.scale.height),s=this.add.rectangle(0,0,this.scale.width,this.scale.height,0,.6).setOrigin(0).setInteractive();s.once("pointerdown",(()=>{this.closeDropScene()}));const n=this.add.particles(this.scale.width/2,this.scale.height/2,"star",{speed:{min:-400,max:400},lifespan:3e3,gravityY:0}),{width:r,height:o}=this.scale,a=.8*Math.min(r/768,o/1024),i=P(this,t,0,0,1,u.Front,(()=>this.closeDropScene())),m=i.getBounds(),l=this.add.container(r/2,o/2);i.x=-m.width/2,i.y=-m.height/2,l.add(i),l.setScale(0);const _={fontFamily:"Cinzel",fontSize:"22px",color:"#ffd700",stroke:"#000",strokeThickness:2,align:"center"},d=this.add.text(this.scale.width/2,o-200,"",_).setDepth(10).setOrigin(.5,0).setWordWrapWidth(600);d.setText(t.description);const c=this.add.text(this.scale.width/2,80,"New Companion Found!",{fontFamily:"Cinzel",fontSize:"32px",color:"#ffffff"}).setOrigin(.5),h=this.add.text(this.scale.width/2,125,"Visit the Deck Builder to add review and add to your champions.",{fontFamily:"Cinzel",fontSize:"18px",color:"#ffffff"}).setOrigin(.5);this.tweens.add({targets:l,scale:a,ease:"Back.Out",duration:300}),this.contentContainer.add([e,s,n,l,d,c,h])}else this.closeDropScene()}closeDropScene(){this.scene.stop("CardDropScene"),R.lastScene&&this.scene.start(R.lastScene)}},class extends E{constructor(){super("VictoryScene")}preload(){this.load.image("victory-bg","assets/backgrounds/victory.jpg"),this.load.image("confetti","assets/ui/confetti.png")}create(){super.create();const{width:e,height:t}=this.scale;x(this),T(this,"victory");const s=this.add.image(e/2,t/2,"victory-bg").setDisplaySize(e,t),n=this.add.graphics();n.fillStyle(0,.6),n.fillRoundedRect(40,100,e-80,t-300,30);const r=this.add.text(e/2,140,"After a long and perilous journey,\nyou entered the realm of the Lich King,\nbraving darkness, monsters, and traps.\n\nAgainst all odds, you triumphed in battle\nand rescued the princess from her eternal prison.\n\nYour tale became legend, and together,\nyou lived happily ever after.",{fontFamily:"Cinzel",fontSize:"26px",color:"#ffffff",align:"center",wordWrap:{width:e-120}}).setOrigin(.5,0).setDepth(1),o=this.add.particles(0,0,"confetti",{x:{min:0,max:e},y:0,lifespan:4300,speedY:{min:100,max:300},scale:{start:.5,end:0},quantity:4,frequency:200,rotate:{min:-180,max:180},blendMode:"ADD",color:[16777215,16776960,65280,16711680]}),a=this.add.text(e/2,t-100,"Main Menu",{fontFamily:"Cinzel",fontSize:"36px",color:"#ffffff",backgroundColor:"#222222",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setInteractive({useHandCursor:!0});a.on("pointerdown",(()=>{this.scene.start("MainMenuScene")})),this.contentContainer.add([s,n,r,o,a])}},class extends E{constructor(){super("ExplorationScene"),t(this,"stageId"),t(this,"stepIndex",0),t(this,"cards",[]),t(this,"cardManager"),t(this,"stages"),t(this,"currentStage"),t(this,"isFlippingCard",!1),this.cardManager=new p}init(){if(this.stageId=v.instance.data.progress.currentStage,this.stepIndex=v.instance.data.progress.currentStep,this.isFlippingCard=!1,this.stages=y.instance.stages,this.currentStage=this.stages.find((e=>e.stageNumber===this.stageId)),v.instance.data.progress.currentStep>=this.currentStage.steps.length){v.instance.data.progress.currentStage+=1,v.instance.data.progress.currentStep=0;const e=v.instance.data.progress.currentStage%5==1;v.instance.data.progress.currentStage>50?this.scene.start("VictoryScene"):this.cardManager.playerHasEligibleCardDrops(v.instance.data.collection)?(R.lastScene=e?"StoryScene":"AdventureScene",this.scene.start("CardDropScene")):this.scene.start(e?"StoryScene":"AdventureScene")}}preload(){this.currentStage&&this.load.image(this.currentStage.image,`assets/backgrounds/stages/${this.currentStage.image}`)}create(){super.create(),x(this);const e=this.add.image(0,0,this.currentStage.image).setOrigin(0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0);T(this,`music_stage_${Math.floor((v.instance.data.progress.currentStage-1)/5)+1}`);const t=this.add.text(20,this.scale.height-90,`Level: ${v.instance.data.level}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2),s=Math.floor(this.stepIndex/this.currentStage.steps.length*100),n=this.add.text(20,this.scale.height-70,`${this.currentStage.title} - Progress: ${s}%`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2);this.contentContainer.add([e,t,n]);for(let a=0;a<v.instance.data.equippedCards.length;a++){const e=15+140*a,t=this.cardManager.getById(v.instance.data.equippedCards[a]);if(t){var r=P(this,t,e,this.scale.height-300,.17,u.Front,(()=>this.scene.launch("CardPreviewScene",{data:t})));r.setDepth(2),this.contentContainer.add(r)}}if(v.instance.data.level<50){const e=this.add.text(20,this.scale.height-50,`EXP to next level: ${v.instance.data.expToNextLevel}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2);this.contentContainer.add(e)}const o=this.cardManager.getMaxCardCost(v.instance.data.level)-this.cardManager.getUsedCardCost(v.instance.data.equippedCards);if(o>0){const e=this.add.text(20,this.scale.height-30,`Available points: ${o}`,{fontFamily:"Cinzel, serif",fontSize:"16px",color:"#ffffff"}).setDepth(2);this.contentContainer.add(e),B(this,this.scale.width-100,this.scale.height-30,"Deck Builder",(()=>{this.scene.stop("ExplorationScene"),R.lastScene=this.scene.key,this.scene.start("DeckBuilderScene")}),16)}this.showCardChoices(),F(this)}showCardChoices(){const e=this.scale.width/2-220;for(let t=0;t<3;t++){const s=e+220*t,n=this.add.image(s,this.scale.height-600,"card-back-adventure").setInteractive({useHandCursor:!0}).setOrigin(.5).setScale(.25).setDepth(2);n.on("pointerdown",(()=>this.handleCardChoice(n))),this.cards.push(n),this.contentContainer.add(n)}}flipCard(e,t,s){this.tweens.add({targets:e,scaleX:0,duration:150,ease:"Linear",onComplete:()=>{e.setTexture(t),this.tweens.add({targets:e,scaleX:.25,duration:150,ease:"Linear",onComplete:()=>{this.time.delayedCall(250,(()=>this.processCardChoice(s)))}})}})}handleCardChoice(e){if(this.isFlippingCard)return;this.isFlippingCard=!0;const t=Math.random();let s="continue";t<.16&&this.cardManager.playerHasEligibleCardDrops(v.instance.data.collection)?s="rareDrop":t<.6&&(s="battle"),this.stepIndex==this.currentStage.steps.length-1&&(s="battle"),this.currentStage.steps[this.stepIndex].type==g.Boss&&(s="battle");let n="";"continue"===s?n="card_continue":"battle"===s?n="card_battle":"rareDrop"===s&&(n="card_drop"),this.flipCard(e,n,s)}processCardChoice(e){"continue"===e?(N(this,"foot"),this.stepIndex++,v.instance.data.progress.currentStep=this.stepIndex,v.instance.grantExp(!1),this.playForwardMotionEffect()):"battle"===e?this.triggerAlarmEffect():(this.stepIndex++,v.instance.grantExp(!1),v.instance.data.progress.currentStep=this.stepIndex,R.lastScene=this.scene.key,this.scene.start("CardDropScene"))}playForwardMotionEffect(){const e=this.add.image(this.scale.width/2,this.scale.height/2,this.currentStage.image).setOrigin(.5,.5).setScale(1).setAlpha(1).setDepth(1);this.contentContainer.add(e);const t=this.scale.width/e.width,s=this.scale.height/e.height,n=Math.max(t,s);e.setScale(n),this.tweens.add({targets:e,scale:2*n,alpha:0,duration:1e3,ease:"Cubic.easeOut",onComplete:()=>{e.destroy(),this.scene.restart()}})}triggerAlarmEffect(){N(this,"horn");const e=this.add.rectangle(0,0,this.scale.width,this.scale.height,16711680,.5).setOrigin(0,0).setDepth(100),t=this.add.text(this.scale.width/2,this.scale.height/2,"BATTLE!",{fontFamily:"Cinzel, serif",fontSize:"64px",color:"#ffff00",fontStyle:"bold",stroke:"#000",strokeThickness:6}).setOrigin(.5).setAlpha(.75).setDepth(101);this.contentContainer.add([e,t]);let s=0;const n=()=>{s>=3&&this.scene.start("CombatScene",{stageId:this.stageId,stepId:this.stepIndex}),this.tweens.add({targets:e,alpha:.5,duration:250,yoyo:!0,ease:"Power2",onComplete:()=>{s++,n()}})};n()}},class extends E{constructor(){super("CardPreviewScene"),t(this,"cardData")}init(e){this.cardData=e.data}create(){super.create();const{width:e,height:t}=this.scale,s=this.add.rectangle(0,0,e,t,0,.9).setOrigin(0).setInteractive(),n=.8*Math.min(e/768,t/1024),r=P(this,this.cardData,0,0,1,u.Front),o=r.getBounds(),a=this.add.container(e/2,t/2);r.x=-o.width/2,r.y=-o.height/2,a.add(r),a.setScale(0),this.tweens.add({targets:a,scale:n,ease:"Back.Out",duration:300}),s.once("pointerdown",(()=>{this.closePreview(a)}));const i=this.add.text(this.scale.width/2,t-200,"",{fontFamily:"Cinzel",fontSize:"22px",color:"#ffd700",stroke:"#000",strokeThickness:2,align:"center"}).setDepth(10).setOrigin(.5,0).setWordWrapWidth(600);i.setText(this.cardData.description),this.contentContainer.add([s,a,i])}closePreview(e){this.tweens.add({targets:e,scale:0,ease:"Back.In",duration:250,onComplete:()=>{this.scene.stop()}})}},class extends E{constructor(){super("StoryScene"),t(this,"stages"),t(this,"currentStage"),t(this,"dialogContainer"),t(this,"storyIndex",0)}preload(){this.stages=y.instance.stages,this.storyIndex=0,this.currentStage=this.stages.find((e=>e.stageNumber===v.instance.data.progress.currentStage)),this.load.image(this.currentStage.image,`assets/backgrounds/stages/${this.currentStage.image}`),this.currentStage.story.forEach((e=>{""!=e.image&&this.load.image(e.image,`assets/characters/${e.image}.jpg`)}))}create(){super.create();const e=this.add.image(this.scale.width/2,this.scale.height/2,this.currentStage.image).setDisplaySize(this.scale.width,this.scale.height).setScale(1);this.dialogContainer=this.make.container({x:0,y:0,add:!1}),this.showDialog(),this.contentContainer.add([e,this.dialogContainer]),this.input.on("pointerdown",(()=>{this.storyIndex++,this.storyIndex<this.currentStage.story.length?this.showDialog():this.scene.start("ExplorationScene")})),F(this)}showDialog(){this.dialogContainer.removeAll(!0);const e=this.currentStage.story[this.storyIndex],t="Narrator"===e.name,s=this.storyIndex%2==0,n=this.add.image(0,0,e.image).setDisplaySize(128,128);""===e.image&&n.setVisible(!1);const r=this.add.text(0,0,e.lines,{fontFamily:"Cinzel, serif",fontSize:"22px",color:"#ffffff",wordWrap:{width:450},padding:{x:20,y:20}}),o=r.width+20,a=r.height+20,i=this.add.graphics();i.fillStyle(0,.6),i.fillRoundedRect(0,0,o,a,16);const m=this.add.container(0,0,[i,r]);r.setPosition(10,10),t?(n.setPosition(this.scale.width/2,100).setOrigin(.5,0),m.setPosition(this.scale.width/2-o/2,240)):s?(n.setPosition(50,this.scale.height-400).setOrigin(0,0),m.setPosition(190,this.scale.height-380)):(n.setPosition(this.scale.width-50,this.scale.height-400).setOrigin(1,0),m.setPosition(this.scale.width-190-o,this.scale.height-380)),this.dialogContainer.add([n,m])}},class extends E{constructor(){super("CollectionScene"),t(this,"cardManager"),t(this,"collectionContainer"),t(this,"scrollbar"),t(this,"listBackground"),this.cardManager=new p}create(){super.create();const e=this.add.image(0,0,"deck-builder").setOrigin(0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),t=this.add.rectangle(0,0,this.scale.width,this.scale.height,0,.4).setOrigin(0),s=this.add.text(this.scale.width/2,40,"Card Collection",{fontFamily:"Cinzel",fontSize:"32px",color:"#fff"}).setOrigin(.5);B(this,this.scale.width/2,this.scale.height-60,"Back to Menu",(()=>this.scene.start("MainMenuScene"))).setDepth(10),this.contentContainer.add([e,t,s]),this.createCollectionList(),F(this)}createCollectionList(){const e=90,t=this.scale.width-100,s=this.scale.height-200;this.collectionContainer&&this.collectionContainer.destroy(!0),this.scrollbar&&this.scrollbar.destroy(),this.listBackground&&this.listBackground.destroy(),this.listBackground=this.add.rectangle(40,80,t+20,s+20,0,.7).setOrigin(0);const n=this.add.graphics();n.fillRect(50,e,t,s);const r=n.createGeometryMask();this.collectionContainer=this.make.container({x:50,y:e,add:!1}),this.collectionContainer.setMask(r);const a=this.cardManager.getAll().sort(((e,t)=>{const s=d[t.rarity]-d[e.rarity];return 0!==s?s:e.name.localeCompare(t.name)}));let i=0,m=0,l=0,_=0;a.forEach(((e,t)=>{const s=v.instance.data.collection.includes(e.id)?u.Front:u.Back,n=P(this,e,0,0,.24,s,(()=>{s===u.Front&&this.scene.launch("CardPreviewScene",{data:e})})),r=n.getBounds().width,o=n.getBounds().height;n.x=m,n.y=l,this.collectionContainer.add(n),m+=r+20,_=Math.max(_,o),(t+1)%3==0&&(m=0,l+=_+20,_=0)})),this.collectionContainer.height=l+_;const c=Math.max(s/this.collectionContainer.height*s,20);this.scrollbar=this.add.rectangle(50+t-6,e,6,c,16777215,.4).setOrigin(0,0);const h=()=>{i=o.Math.Clamp(i,0,Math.max(0,this.collectionContainer.height-s)),this.collectionContainer.y=e-i;const t=i/(this.collectionContainer.height-s);this.scrollbar.y=e+t*(s-this.scrollbar.displayHeight)};this.input.on("wheel",((e,t,s,n)=>{i+=n,h()}));let g=!1,p=0;this.input.on("pointerdown",(t=>{g=t.y>=e&&t.y<=e+s,p=t.y})),this.input.on("pointermove",(e=>{if(!g||!e.isDown)return;const t=e.y-p;i-=t,h(),p=e.y})),this.input.on("pointerup",(()=>g=!1)),this.contentContainer.add([this.collectionContainer,this.scrollbar]),h()}},class extends E{constructor(){super("HowToPlayScene"),t(this,"scrollY",0),t(this,"contentHeight",0),t(this,"scrollMask"),t(this,"content"),t(this,"maxScrollY",0)}create(){super.create();const{width:e,height:t}=this.scale,s=this.add.image(0,0,"deck-builder").setOrigin(0).setDisplaySize(this.scale.width,this.scale.height).setDepth(0),n=this.add.rectangle(0,0,this.scale.width,this.scale.height,0,.6).setOrigin(0),r=this.add.text(e/2,80,"How to Play",{fontFamily:"Cinzel",fontSize:"48px",color:"#ffffff"}).setOrigin(.5);this.content=this.make.container({x:0,y:0,add:!1});const a={fontFamily:"Cinzel",fontSize:"24px",color:"#ffffff",wordWrap:{width:e-100},align:"left"};let i=0;["You start the game with 8 random cards.","5 of these cards form your starting deck.","As you progress, you discover more cards.","Use the Deck Builder to customize your deck.","","The game has 10 chapters with 5 stages each.","Each stage has an exploration phase.","During exploration, choose 1 card out of 3.","Cards may progress you, trigger combat, or give a new card.","","Combat is turn-based. You attack first.","Use your 5-card deck during combat.","Each card has a cost shown in the top-left.","The cards HP is shown bottom left.","The cards Attack is shown in the right.","Your total deck cost cannot exceed your max cost.","Max cost increases as you level up.","","If you're stuck, use Random Battle from the main menu.","Random Battles give extra card rewards.","","Use the Deck Builder to choose your best 5 cards.","Try to maximize power while staying within your cost limit.","","The Collection screen shows how many cards you've discovered.","Aim to collect them all!"].forEach((e=>{const t=this.add.text(50,i,e,a);this.content.add(t),i+=""===e?20:t.height+10})),this.contentHeight=i,this.maxScrollY=Math.max(0,this.contentHeight-t+180),this.content.y=150;const m=this.make.graphics({});m.fillStyle(16777215),m.fillRect(0,150,e,t-300),this.scrollMask=m.createGeometryMask(),this.content.setMask(this.scrollMask),this.input.on("pointermove",(e=>{e.isDown&&(this.scrollY-=.02*e.velocity.y,this.scrollY=o.Math.Clamp(this.scrollY,0,this.maxScrollY),this.content.y=150-this.scrollY)}));const l=this.add.text(e/2,t-80,"Main Menu",{fontFamily:"Cinzel",fontSize:"32px",color:"#ffffff",backgroundColor:"#444",padding:{x:20,y:10}}).setOrigin(.5).setInteractive({useHandCursor:!0});l.on("pointerdown",(()=>{this.scene.start("MainMenuScene")})),this.contentContainer.add([s,n,r,this.content,l]),F(this)}},class extends E{constructor(){super("paused"),t(this,"onResumeCallback")}init(e){this.onResumeCallback=e.onResume}create(){var e;super.create();const{width:t,height:s}=this.scale,n=this.add.rectangle(0,0,t,s,0,.75).setOrigin(0),r=this.add.graphics();r.lineStyle(1,16766720,1),r.strokeRect(15,15,t-30,s-30);const o=this.add.text(t/2,s/2,"Game Paused",{fontFamily:"Cinzel, serif",fontSize:"36px",color:"#FFD700",align:"center",stroke:"#000000",strokeThickness:2,shadow:{offsetX:2,offsetY:2,color:"#000000",blur:4,fill:!0}});o.setOrigin(.5);const a=this.add.text(t/2,s/2+50,"Click or press any key to resume",{fontFamily:"Cinzel, serif",fontSize:"18px",color:"#FFFFFF",align:"center"});a.setOrigin(.5),this.input.once("pointerdown",(()=>this.resumeGame())),null==(e=this.input.keyboard)||e.once("keydown",(()=>this.resumeGame())),this.contentContainer.add([n,r,o,a])}resumeGame(){this.onResumeCallback&&this.onResumeCallback()}}]},Y=e=>{const t=new r.Game({...$,parent:e});return window.addEventListener("resize",(()=>{const{width:e,height:s}=U();t.scale.resize(e,s),console.log("resize to",e,s),t.canvas.style.width=`${e}px`,t.canvas.style.height=`${s}px`})),t};document.addEventListener("DOMContentLoaded",(()=>{window.addEventListener("load",(()=>{setTimeout((()=>{Y("game-container")}),100)})),Y("game-container")}));
